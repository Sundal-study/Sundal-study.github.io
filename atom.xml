<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>山外Sundal</title>
  
  <subtitle>这个世界我来过</subtitle>
  <link href="https://sundal.top/atom.xml" rel="self"/>
  
  <link href="https://sundal.top/"/>
  <updated>2020-11-14T04:35:08.855Z</updated>
  <id>https://sundal.top/</id>
  
  <author>
    <name>山外Sundal</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>【阿里云-存储】混合云容灾服务</title>
    <link href="https://sundal.top/2020/11/13/09%20%E4%BA%91%E8%AE%A1%E7%AE%97/9.4%20%E9%98%BF%E9%87%8C%E4%BA%91/%E3%80%90%E9%98%BF%E9%87%8C%E4%BA%91-%E5%AD%98%E5%82%A8%E3%80%91%E6%B7%B7%E5%90%88%E4%BA%91%E5%AE%B9%E7%81%BE%E6%9C%8D%E5%8A%A1/"/>
    <id>https://sundal.top/2020/11/13/09%20%E4%BA%91%E8%AE%A1%E7%AE%97/9.4%20%E9%98%BF%E9%87%8C%E4%BA%91/%E3%80%90%E9%98%BF%E9%87%8C%E4%BA%91-%E5%AD%98%E5%82%A8%E3%80%91%E6%B7%B7%E5%90%88%E4%BA%91%E5%AE%B9%E7%81%BE%E6%9C%8D%E5%8A%A1/</id>
    <published>2020-11-13T11:18:37.874Z</published>
    <updated>2020-11-14T04:35:08.855Z</updated>
    
    <content type="html"><![CDATA[<p>混合云容灾（Hybrid Disaster Recovery) 是一个为企业应用提供云上和本地双备份与云容灾的服务。配合灾备一体机硬件，可以高效保障数据安全性和业务连续性。</p><h3 id="一、混合云容灾服务概述"><a href="#一、混合云容灾服务概述" class="headerlink" title="一、混合云容灾服务概述"></a>一、混合云容灾服务概述</h3><h4 id="1-1-什么是混合云容灾服务"><a href="#1-1-什么是混合云容灾服务" class="headerlink" title="1.1 什么是混合云容灾服务"></a>1.1 什么是混合云容灾服务</h4><p>混合云容灾服务（Hybrid Disaster Recovery， 简称 HDR）是一个为您的数据中心提供企业级应用的本地备份与云上容灾一体化的服务。</p><h5 id="混合云容灾服务解决的核心问题"><a href="#混合云容灾服务解决的核心问题" class="headerlink" title="混合云容灾服务解决的核心问题"></a>混合云容灾服务解决的核心问题</h5><p>混合云容灾解决的两个核心问题是：</p><ul><li>应用级容灾 - 业务持续性 (Business Continuity) 保障：在数据中心故障或长时间系统维护作业时，在云上快速恢复应用运行，缩短业务停机时间，极大减少损失。</li><li>数据级容灾：在数据中心备份您的数据库、虚拟机、物理机整机，备份数据存储在本地并自动上云。可在自建数据中心发生重大灾害时保障数据安全，同时提供高效的本地和云上的双重恢复。</li></ul><p>此外，利用混合云容灾服务的服务器整机复制能力，您可以方便地将本地服务器迁移到阿里云 ECS，无需重构，您就可以完成应用轻松上云。</p><h5 id="混合云容灾服务支持的业务类型"><a href="#混合云容灾服务支持的业务类型" class="headerlink" title="混合云容灾服务支持的业务类型"></a>混合云容灾服务支持的业务类型</h5><p>混合云容灾服务目前支持两种业务类型：</p><ul><li><strong>连续复制型容灾（CDR）</strong>：解决企业关键应用的高标准容灾方案，提供<a href="https://help.aliyun.com/document_detail/91324.html#concept-91324-zh">秒-分级的 RPO 和 RTO 容灾</a>。</li><li><strong>混合云大数据容灾</strong>（公测中）：解决 Hadoop 集群数据的实时容灾复制，跨集群大数据湖建设，Hadoop 备份的问题，实现<a href="https://help.aliyun.com/document_detail/85812.html#concept-85812-zh">大数据集群间的近 0 RPO</a> 实时双向复制。</li></ul><h4 id="1-2-产品优势"><a href="#1-2-产品优势" class="headerlink" title="1.2 产品优势"></a>1.2 产品优势</h4><p>阿里云拥有世界水平的基础设施，随用随取的海量弹性资源，简单易用的计算、存储、网络、数据库、大数据服务，是企业天然的灾备中心。利用混合云容灾服务搭建基于阿里云的异地容灾方案是企业业务连续性和数据安全保障的理想选择。</p><h5 id="总成本低廉"><a href="#总成本低廉" class="headerlink" title="总成本低廉"></a>总成本低廉</h5><ul><li>无需自建灾备中心，免去机房运维、硬件采购等成本。</li><li>云上主要消耗存储资源、计算资源需求极低。</li><li>可针对不同的应用需求以及不同的网络带宽，配置不同的 RPO、RTO，从而节约成本。</li><li>相对自建灾备中心的方案，可以节约高达 80% 的费用。</li></ul><h5 id="简单易用"><a href="#简单易用" class="headerlink" title="简单易用"></a>简单易用</h5><ul><li>云下部署简单、云上资源全自动管理、控制台集中管控。</li><li>备份恢复演练和容灾恢复演练可随时进行，一键启动、快速清理。</li></ul><h5 id="RPO-RTO分级"><a href="#RPO-RTO分级" class="headerlink" title="RPO/RTO分级"></a>RPO/RTO分级</h5><p>企业需要对重要性级别不同的应用制定阶梯化的 RPO/RTO。企业的基础架构，尤其是网络情况会制约能达到的容灾指标。</p><ul><li>连续复制型容灾（CDR）基于磁盘级实时数据复制技术，可以提供秒级-分钟级的 RPO/RTO。</li><li>混合云大数据容灾提供近 0 RPO 的大数据容灾，可以将 Hadoop 集群容灾至阿里云 OSS 或 EMR，在 Hadoop 集群间双向实时复制，构建大数据湖。</li></ul><h5 id="应用级容灾和数据级容灾"><a href="#应用级容灾和数据级容灾" class="headerlink" title="应用级容灾和数据级容灾"></a>应用级容灾和数据级容灾</h5><ul><li>支持将 Windows、 Linux 应用服务器做高效的容灾复制和云上恢复，实现应用级容灾。</li><li>您可以只针对关键应用的数据，包括 SQL Server、Oracle 数据库、VMWare 虚拟机等进行定时备份和备份上云，实现数据级容灾。</li></ul><h4 id="1-3-应用场景"><a href="#1-3-应用场景" class="headerlink" title="1.3 应用场景"></a>1.3 应用场景</h4><p>混合云容灾服务可以广泛地应用于各种数据保护和业务持续性场景。</p><h5 id="关键应用的异地容灾"><a href="#关键应用的异地容灾" class="headerlink" title="关键应用的异地容灾"></a>关键应用的异地容灾</h5><p>在本地数据中心上运行的应用可能面临各种意外情况。例如，由于软硬件环境被破坏而无法在短时间内恢复应用，火灾、自然灾害等事件甚至可能导致整个数据中心的重建。这些情况会导致关键应用长时间不可使用，从而对您的业务造成较大损失。当自有 IDC 内的应用无法短时间恢复时，混合云容灾服务能够帮助您将应用在云上快速拉起。</p><p>使用混合云容灾网关后，核心应用的服务器镜像、应用数据、文件等都被持续复制到阿里云上。如果自有 IDC 内应用出现难以恢复的故障时，您可以在阿里云上启动容灾恢复网关，快速在 ECS 上恢复应用服务器运行，使应用迅速重新上线，极大减少业务损失。平时，您还可以方便地进行容灾演练，确保真实故障发生时恢复流程顺畅，保证容灾计划的准确性。</p><p>混合云容灾服务让您无需承担自建灾备中心的巨大投入，也无需担心传统容灾方案复杂的软硬件部署运维，极大减少了异地容灾的成本，提高容灾的有效性。</p><h5 id="整机云迁移"><a href="#整机云迁移" class="headerlink" title="整机云迁移"></a>整机云迁移</h5><p>传统的上云迁移一般需要应用在云镜像上重新安装配置，ECS虚拟机重新配置，甚至应用重构等步骤，这个过程往往比较漫长。尤其是一些第三方开发的应用，因为软件依赖多且不明确、配置复杂等情况，上云迁移操作较为困难。</p><p>混合云容灾网关或者灾备一体机提供了整机备份上云并在云上恢复的方式，让您可以在 ECS 中非常方便地真实还原云下服务器环境，让上云迁移变得简单直观。</p><h4 id="1-4-基本概念"><a href="#1-4-基本概念" class="headerlink" title="1.4 基本概念"></a>1.4 基本概念</h4><p>故障转移（Fail Over）：即容灾恢复，指您的 IDC 应用出现故障时，在阿里云上恢复应用的过程。</p><p>故障恢复 （Fail Back)：当您的 IDC 内的环境恢复以后，将应用数据迁回自有 IDC 恢复应用运行的过程。</p><p>RPO：Recovery Point Objective（数据恢复点目标），指应用发生故障时预期的数据丢失量。例如，RPO = 15 分钟，表示在应用发生故障时，最近 15 分钟的数据无法在云上恢复。</p><p>RTO：Recovery Time Objective（恢复时间目标），指故障发生时，在云上将应用恢复运行所需要的时间。</p><p>混合云灾备一体机：阿里云推出的具有容灾备份功能的一体机。</p><h4 id="1-5-灾备规划"><a href="#1-5-灾备规划" class="headerlink" title="1.5 灾备规划"></a>1.5 灾备规划</h4><p>云容灾服务因免去了灾备中心建设、硬件系统采购、运维等复杂的工作，加上资源可弹性扩展、按量付费的特性、已经大大降低了规划工作的难度。您只需花少量的时间进行选型、规划等就可以轻松使用阿里云作为您的容灾服务提供者。本文档将从需求分析、RTO/RPO 要求、应用的分析、灾备设备和网络环境等方面阐述如何有效地进行灾备规划。</p><h5 id="需求分析"><a href="#需求分析" class="headerlink" title="需求分析"></a>需求分析</h5><p>数据保护和业务连续性对数据中心的意义重大，关键应用的故障或数据丢失会对您的业务造成重大损失。混合云容灾服务提供了两个层次的能力来保护数据，并确保业务连续性。</p><ul><li><p>异地备份</p><p>服务器镜像和数据备份后会直接上传至阿里云灾备库，实现高可靠的云上异地备份。稳定的异地备份确保关键数据在本地数据中心发生火灾等极端情况下不丢失，在本地设施修复后恢复至本地。</p></li><li><p>云上容灾</p><p>为减少因应用故障导致的业务损失，当数据中心出现严重故障无法快速恢复时，混合云容灾服务可以高效地在 ECS 上快速恢复您的应用。</p></li></ul><h5 id="RTO-RPO要求"><a href="#RTO-RPO要求" class="headerlink" title="RTO/RPO要求"></a>RTO/RPO要求</h5><p>应用容灾有两个核心的指标：</p><ul><li>RPO：指应用发生故障时可以容忍的数据丢失量。数据越重要，RPO 就要求越小。RPO 越高，往往要求数据备份、复制频率更高，对生产环境、网络的压力也会越大，成本通常也越高。</li><li>RTO：故障发生后，期望从启动容灾恢复操作到应用恢复上线所需要的时间。故障单位时间内对业务造成的损失越大，RTO 就要求越短。</li></ul><p>RTO、RPO 一般由业务部门提出要求，与 IT 部门共同商议，基于技术可行性、对现有系统影响、成本等多方面综合考量综合得出。RTO、RPO 标准的高低与基础设施成本往往有线性关系。</p><p>您也可以参考国家和行业标准来制定 RTO、RPO 目标。<a href="http://www.djbh.net/webdev/file/webFiles/File/cpzg/20122616046.pdf">GB/T 20988-2007标准</a> 是中国国家标准化管理委员会制定的信息系统灾难恢复规范。附录中有某行业 RPO/RTO 的等级规范示例，如下所示。<a href="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/8161787851/p32398.png"><img src="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/8161787851/p32398.png" alt="img"></a></p><p>混合云容灾服务提供了简单的配置来满足不同的 RPO 和 RTO 要求。例如，连续复制型容灾（CDR）可以提供秒级到分钟级的 RPO和RTO。</p><h5 id="应用的分析"><a href="#应用的分析" class="headerlink" title="应用的分析"></a>应用的分析</h5><p>容灾部署前，您需要了解关键应用的部署、环境的依赖以及应用的客户端连接等情况。</p><ul><li><p>应用的部署</p><p>部署关键应用前，您需要考虑以下三个要素：</p><ul><li>该应用包含哪些服务器</li><li>服务器之间的网络连接</li><li>服务器内需要做哪些配置</li></ul><p>例如，一个简单的网页应用包含以下要素：</p><ul><li>该应用包含：1 个数据库服务器，1 个后端服务器，1 个 Web 前端服务器。</li><li>3 个服务器处于同一网络。</li><li>后端服务器内有一个配置项指定数据库服务器 IP，Web 前端服务器有个配置项指明后端服务器 IP。</li></ul><p>识别这些要素之后，可以做如下计划：</p><ul><li>混合云容灾服务需要保护这 3 台服务器。</li><li>阿里云上恢复时，需要将这3台服务器恢复在同一个 VPC 内。</li><li>整机恢复后，为确保这个应用能够运行，必须确保恢复时用与云下相同的 IP。或者，确保在恢复完成后用自动化脚本修改配置项。</li></ul></li><li><p>环境的依赖</p><p>应用容灾是一个需要多部门合作完成的过程，包括应用管理员、机房管理员和网络管理员等角色的配合实施。一个能够满足业务要求的完整的灾备方案需要考虑多个方面的细节，主要包括：</p><ul><li>应用所依赖的环境，例如 Active Directory（AD）、DNS 等</li><li>应用所需要的网络配置</li></ul><p>很多情况下，应用的运行还有一些重要的环境依赖。例如在 Windows 环境中，很多应用都依赖 AD 运行。那么在云上恢复的时候，您云上的 VPC 环境必须能够连接 AD 服务。当然，DNS 服务也是很多环境下的强需求。</p><p>以 AD 为例，通常会有以下两种情况：</p><ul><li>如果您已经在不同的数据中心内部署了多个主从 AD 服务器 ，那么您只需要在 AD 所在的数据中心和云上 VPC 之间能够建立高速通道或者 SSLVPN 连接即可。</li><li>如果您的 AD 服务器是集中部署在一个数据中心，可能发生同一时间离线的情况，建议您：<ul><li>用混合云灾备一体机保护 AD 服务器，在云下发生故障时首先恢复这台 AD 服务器。</li><li>在云上 VPC 里部署一个从 AD 服务器，与云下的主 AD 服务器保持连接。云下发生故障时，使用云上 AD。</li></ul></li></ul><p>同样，DNS 服务器也需要进行相应的配置才能满足灾备后的应用环境要求。</p></li><li><p>应用的客户端连接</p><p>应用恢复后，需要确保客户端能够连接恢复出来的应用。通常情况下，您需要：</p><ul><li>如果恢复出的应用服务器 IP 与原始的一样，DNS 服务器也成功恢复，那么只需要客户端与应用有网络连接即可。您可能需要用 SSLVPN 或者高速通道来确保客户端能与云上恢复出的应用有连接，或者恢复出的应用提供公网 IP 让客户端接入。</li><li>应用恢复的时候不要求必须使用原始 IP，您也可以修改 DNS 确保客户端可以连接新的服务。</li><li>如果域名和 IP 都发生变化，您需要修改客户端。</li></ul></li></ul><h5 id="灾备设备和网络环境"><a href="#灾备设备和网络环境" class="headerlink" title="灾备设备和网络环境"></a>灾备设备和网络环境</h5><p>根据应用服务器的数量、数据量、RRO/RTO 的标准、以及所依赖环境设施的要求，您可以合理选用灾备设备并部署合适的网络环境。</p><ul><li><p>CDR 灾备一体机</p><p>如果支持虚拟化环境，且需要容灾保护的服务器数量少于 5 台 ，建议您进行虚拟化部署。</p><p>如果不支持虚拟化环境，或者容灾保护的服务器数量在 5 台以上，建议使用 CDR 灾备一体机。可选择的一体机型号如下所示：</p><table><thead><tr><th align="left">型号</th><th align="left">支持服务器数量</th></tr></thead><tbody><tr><td align="left">Apsara DR100</td><td align="left">&lt; 20</td></tr><tr><td align="left">Apsara DR200</td><td align="left">&lt; 50</td></tr></tbody></table></li><li><p>网络环境</p><p>以上灾备设备要求的网络环境包括以下两种：</p><ul><li>数据中心到阿里云之间的网络<ul><li>由于优化了数据存储传输算法，混合云容灾服务并不强制要求本地数据中心与阿里云建立专线连接。但是对于大数据量、严格 RPO 要求的场景，建议您使用专线连接，以确保容灾服务能够达到要求的指标。</li><li>应用恢复后，根据客户端、AD、DNS 等与阿里云 VPC 的连接需求，您可能需要考虑通过 SSLVPN、高速通道连接、应用暴露公网 IP 等方式来确保应用的正常使用。</li></ul></li><li>混合云灾备一体机到被保护服务器之间的网络<ul><li>为了对被保护服务器进行正常备份恢复，需要灾备一体机和被保护服务器之间有网络连接。</li><li>备份一体机提供了双千兆、双万兆网卡供选择，您可以根据备份恢复吞吐要求按需配置。</li></ul></li></ul></li></ul><h4 id="1-6-鉴权规则"><a href="#1-6-鉴权规则" class="headerlink" title="1.6 鉴权规则"></a>1.6 鉴权规则</h4><p>本文提供了在混合云容灾HDR通过访问控制RAM实现团队或者部门成员鉴权、RAM用户授权、RAM角色授权、以及跨云服务授权的Action列表和Resource列表，适用于创建自定义策略实现精细化权限控制的业务需求。</p><h5 id="背景信息"><a href="#背景信息" class="headerlink" title="背景信息"></a>背景信息</h5><p><strong>说明</strong> 如果您无需授权就能访问目标资源，可以跳过此章节。</p><p>默认情况下，主账号或者RAM账号均能使用HDR控制台完整操作自己创建的HDR资源。在以下场景中，会涉及到操作授权问题：</p><ul><li>RAM账号刚创建时没有权限操作主账号的资源。</li><li>从其他阿里云服务访问HDR资源，或者HDR访问其他阿里云服务。</li><li>操作具有权限控制的HDR资源前，需要资源拥有者授权目标资源的行为权限。</li></ul><p>当其他账号通过HDR访问主账号资源时，阿里云HDR首先向RAM发起权限检查，以确保资源拥有者已经将相关权限授予调用者。您可以阅读<a href="https://help.aliyun.com/document_detail/28627.html#concept-oyr-zzv-tdb">访问控制产品文档</a>更多详情，实现精细化授权策略和权限控制。</p><h5 id="自定义策略"><a href="#自定义策略" class="headerlink" title="自定义策略"></a>自定义策略</h5><p>您可以通过RAM控制台或者调用RAM <a href="https://help.aliyun.com/document_detail/28716.html#doc-api-Ram-CreatePolicy">CreatePolicy</a> API创建一个自定义策略，在<strong>脚本配置</strong>方式的自定义策略中，您需要根据JSON模板文件填写<strong>策略内容</strong>。更多详情请参见<a href="https://help.aliyun.com/document_detail/93738.html#concept-xg5-51g-xdb">权限策略基本元素</a>。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;Version&quot;: &quot;1&quot;,</span><br><span class="line">    &quot;Statement&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;Action&quot;: [</span><br><span class="line">                &quot;hdr:*&quot;</span><br><span class="line">            ],</span><br><span class="line">            &quot;Resource&quot;: [</span><br><span class="line">                &quot;acs:hdr:*:15619224785*****:*&quot;</span><br><span class="line">            ],</span><br><span class="line">            &quot;Effect&quot;: &quot;Allow&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="鉴权列表"><a href="#鉴权列表" class="headerlink" title="鉴权列表"></a>鉴权列表</h5><p><strong>Action</strong>及<strong>Resource</strong>说明请参见<a href="https://help.aliyun.com/document_detail/93738.html#concept-xg5-51g-xdb">权限策略基本元素</a>。</p><table><thead><tr><th align="left">Action</th><th align="left">Resource</th></tr></thead><tbody><tr><td align="left">hdr:*</td><td align="left">acs:hdr:<em>:<uid>:</em></td></tr></tbody></table><h4 id="1-7-控制台概览"><a href="#1-7-控制台概览" class="headerlink" title="1.7 控制台概览"></a>1.7 控制台概览</h4><p>混合云容灾控制台是容灾服务的云上管理入口。</p><p>在混合云容灾控制台中，您可以：</p><ul><li>查看容灾配置总览，包括受保护服务器的数量、类型、所有受容灾保护的数据中心数量、云上资源消耗等。</li><li>监控云上云下容灾网关健康状况。</li><li>部署云上容灾服务网关。</li><li>在阿里云上恢复服务器。</li></ul><h5 id="概览页面"><a href="#概览页面" class="headerlink" title="概览页面"></a>概览页面</h5><p>混合云容灾控制台的概览页，如下图所示：</p><p><a href="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/64145/156775177459346_zh-CN.jpg"><img src="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/64145/156775177459346_zh-CN.jpg" alt="img"></a></p><p>混合云容灾控制台的<strong>概览</strong>页面提供了您所使用的容灾服务的总体情况，包括：</p><ul><li><strong>容灾保护服务器数量</strong>：您在云上和云上所有数据中心内保护的服务器数量。</li><li><strong>容灾站点对数量</strong>：自建数据中心与云上的专有网络配对的容灾站点对数量。</li><li><strong>容灾存储使用量</strong>：备份上云消耗的云上存储量。</li><li><strong>容灾站点对列表</strong>：每一个混合云容灾一体机对应一个容灾中心。该列表显示了每一个混合云灾备一体机和阿里云某个区域的配对。单击列表中的项目，您可以进入<strong>容灾中心</strong>页面查看详情。</li></ul><h5 id="容灾中心页面"><a href="#容灾中心页面" class="headerlink" title="容灾中心页面"></a>容灾中心页面</h5><p>混合云容灾控制台的容灾中心页面，如下图所示：</p><p><a href="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/64145/156775177459351_zh-CN.jpg"><img src="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/64145/156775177459351_zh-CN.jpg" alt="img"></a></p><p>您可以在<strong>容灾中心</strong>页面中查看所有容灾中心的详情，包括：</p><ul><li><strong>站点对信息</strong>页签：您可以查看容灾网关部署环境及所处状态、受保护服务器磁盘容量、计算平台连接状态等信息。</li><li><strong>受保护服务器</strong>页签：您可以查看该容灾中心下被保护的服务器的详细列表。</li><li><strong>任务列表</strong>页签：您可以查看容灾任务详情，如执行的任务类型、创建任务的时间等。</li></ul><h4 id="1-8-服务权限要求"><a href="#1-8-服务权限要求" class="headerlink" title="1.8 服务权限要求"></a>1.8 服务权限要求</h4><p>使用混合云容灾服务，需要开通以下其他服务的权限：</p><ul><li><p>OSS权限</p><p>备份数据需要根据策略上传至阿里云，在云上做容灾恢复时需要从OSS读取备份数据。</p></li><li><p>ECS、云盘权限</p><p>混合云容灾服务需要能够创建、删除、监控您的ECS实例和云盘实例等。</p></li><li><p>VPC权限</p><p>混合云容灾服务需要能够读取您的VPC、vSwitch的信息，以便将ECS实例创建在正确的网络环境中。</p></li></ul><blockquote><p>说明：如果用户已直接授予AliyunHDRFullAccess权限，则不需要再单独开通OSS、 ECS、 VPC等权限。</p></blockquote><hr><h3 id="二、连续复制型容灾CDR"><a href="#二、连续复制型容灾CDR" class="headerlink" title="二、连续复制型容灾CDR"></a>二、连续复制型容灾CDR</h3><h4 id="2-1-连续复制型容灾CDR概述"><a href="#2-1-连续复制型容灾CDR概述" class="headerlink" title="2.1 连续复制型容灾CDR概述"></a>2.1 连续复制型容灾CDR概述</h4><p>连续复制型容灾（ Continuous Data Replication，CDR）是阿里云混合云容灾服务推出的针对企业关键应用的秒—分级 RPO/RTO 业务持续性保障方案。</p><h5 id="解决的核心问题"><a href="#解决的核心问题" class="headerlink" title="解决的核心问题"></a>解决的核心问题</h5><ul><li>业务持续性保障：将企业自建数据中心内或阿里云运行的核心业务数据实时复制上云，达到秒—分级的 RPO。在自建数据中心发生重大故障时，几分钟内在云上拉起，达到分钟级 RTO。</li><li>企业应用在线迁移上云：将自建数据中心内的服务器复制上云后，在云上恢复成 ECS，实现应用的在线迁移上云。</li></ul><h5 id="主要能力"><a href="#主要能力" class="headerlink" title="主要能力"></a>主要能力</h5><ul><li>应用数据实时复制：混合云容灾服务 CDR 能够实时监测和抓取操作系统磁盘和 ECS 云盘中的数据变化并发送至容灾站点，实现数据的实时保护，RPO 达到秒级—分钟级。</li><li>应用在云上快速恢复：复制上云的应用可以在阿里云上以 ECS 的形式快速拉起，所需时间在分钟级别。</li><li>无业务中断的容灾演练：您可以随时对复制上云的应用服务器进行容灾演练，以便验证业务的可恢复性。在验证过程中，源端生产环境不受影响，数据复制不会中断。</li></ul><h5 id="核心优势"><a href="#核心优势" class="headerlink" title="核心优势"></a>核心优势</h5><ul><li>低成本：云上仅消耗云盘资源和少量计算资源。除容灾恢复时段外，无需额外的操作系统、应用系统等的软件授权。</li><li>易上手：无需规划灾备中心，本地数据中心 CDR 网关可以用虚机模板直接部署。客户端安装完成后可以在云上一键启动容灾复制，演练和恢复也可以一键完成。</li><li>高可靠：关于源端服务器负载爆发或重启、容灾网关断电重启、复制链路网络抖动等问题，容灾服务都能够保证数据的持续复制和断点续传。复制上云的数据由阿里云提供数据可靠性保障。</li><li>高安全：AES256数据加密以及HTTPS链路加密，端到端保障数据安全性。</li><li>可验证：容灾上云的系统可以随时演练而不影响生产系统，避免了容灾系统验证难的问题。</li></ul><h4 id="2-2-连续复制型容灾CDR使用限制"><a href="#2-2-连续复制型容灾CDR使用限制" class="headerlink" title="2.2 连续复制型容灾CDR使用限制"></a>2.2 连续复制型容灾CDR使用限制</h4><h5 id="操作系统"><a href="#操作系统" class="headerlink" title="操作系统"></a>操作系统</h5><p>CDR 目前仅支持以下服务器版本。</p><table><thead><tr><th align="left">操作系统</th><th align="left">版本</th></tr></thead><tbody><tr><td align="left">Windows Server</td><td align="left">2008R2、2012、2012R2、2016</td></tr><tr><td align="left">Linux</td><td align="left">Red Hat Enterprise Linux 7.0-7.6Red Hat Enterprise Linux 6.0-6.10CentOS 7.0-7.6CentOS 6.0-6.10<strong>说明</strong> 目前仅支持 64 位系统，如果您需要支持 32 位系统的 Centos 6.x，请联系技术支持。SuSE Linux Enterprise Server 12.0-12.4<strong>说明</strong> 目前仅支持 64 位系统，如果您需要支持 32 位系统的 Enterprise Server 12.x，请联系技术支持。</td></tr></tbody></table><p><strong>说明</strong> 更多 Linux 发行版支持将在近期推出。</p><h5 id="基础架构"><a href="#基础架构" class="headerlink" title="基础架构"></a>基础架构</h5><p>CDR 是基于操作系统层面的磁盘级数据复制技术，与底层基础架构无关。以下是阿里云已经测试验证过的平台。其他平台的验证正在进行中。若您有任何疑问，可以发工单询问。</p><table><thead><tr><th align="left">基础架构</th><th align="left">支持版本</th></tr></thead><tbody><tr><td align="left">物理机</td><td align="left">全面支持</td></tr><tr><td align="left">Hyper-V</td><td align="left">2008R2、2012、2012R2</td></tr><tr><td align="left">vSphere</td><td align="left">5.5、6.0、6.5</td></tr></tbody></table><h5 id="数据库和应用"><a href="#数据库和应用" class="headerlink" title="数据库和应用"></a>数据库和应用</h5><p>CDR 的复制技术与应用无关，因此可以支持任意类型的数据库和应用。</p><p>同时，各类应用往往需要通过自动化脚本来确保应用一致性，混合云容灾服务提供了高效的工具与各类脚本配合使用，确保应用平滑恢复。</p><h5 id="其他限制"><a href="#其他限制" class="headerlink" title="其他限制"></a>其他限制</h5><ul><li>因阿里云系统盘限制，单机系统盘所在物理卷超过 500 GB 的服务器无法在 ECS 上整机恢复。</li><li>数据盘单一物理卷大小不能超过 32 TB。</li></ul><h4 id="2-3-网关一体机告警介绍"><a href="#2-3-网关一体机告警介绍" class="headerlink" title="2.3 网关一体机告警介绍"></a>2.3 网关一体机告警介绍</h4><p>本文介绍网关一体机中磁盘故障、电源故障等硬件告警，以及CPU使用率、内存使用率等软件告警信息。</p><table><thead><tr><th align="left">监控项</th><th align="left">报警阈值</th><th align="left">报警通道</th><th align="left">恢复是否通知</th><th align="left">疲劳度</th><th align="left">是否实时</th></tr></thead><tbody><tr><td align="left">CPU使用率</td><td align="left">一分钟内平均使用率超过95%</td><td align="left">客户邮箱</td><td align="left">是</td><td align="left">每日最多5封</td><td align="left">是</td></tr><tr><td align="left">内存使用率</td><td align="left">一分钟内平均空闲内存小于20%</td><td align="left">客户邮箱</td><td align="left">是</td><td align="left">每日最多3封</td><td align="left">是</td></tr><tr><td align="left">硬盘故障</td><td align="left">磁盘状态出现异常，立即报警</td><td align="left">短信</td><td align="left">是</td><td align="left">每日最多3条</td><td align="left">是</td></tr><tr><td align="left">电源故障</td><td align="left">电源缺失</td><td align="left">短信</td><td align="left">是</td><td align="left">每日最多3条</td><td align="left">是</td></tr></tbody></table><h4 id="2-4-IDC容灾到云"><a href="#2-4-IDC容灾到云" class="headerlink" title="2.4 IDC容灾到云"></a>2.4 IDC容灾到云</h4><h5 id="流程概览"><a href="#流程概览" class="headerlink" title="流程概览"></a>流程概览</h5><p>混合云容灾服务充分利用了公共云资源，极大简化了灾备中心的软硬件准备与运维工作，让您可以只专注于搭建容灾系统。</p><p>您只需要依次执行以下六个步骤即可实现对关键应用的容灾保护，操作流程如下图所示：</p><img src="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/3690579651/p59365.jpg" alt="img" style="zoom:50%;" /><ol><li><p>步骤一：搭建云上专有网络</p><p>准备好用于容灾的云上专有网络（VPC）和交换机（vSwitch），并配置好网段。测试使用时，您可以使用默认配置来创建 VPC 和 vSwtich，或者考虑将云上 VPC 和交换机的网段配成与云下一致。正式容灾时，您可以按照实际情况配置网段。</p></li><li><p>步骤二：创建容灾站点对</p><p>一旦云上网络就绪，您就可以将自建数据中心环境与阿里云上创建好的网络建立容灾关联，即在容灾服务控制台创建一个连续复制型容灾站点对。</p></li><li><p>步骤三：部署CDR网关</p><p>容灾站点配对创建完成后，您就可以在自有机房中下载并部署 CDR 网关了。CDR 网关负责聚合来自所有被容灾保护的服务器上的实时数据流并传输到云上容灾网络环境中。我们提供了用于 VMWare 和 HyperV 环境的虚机模板，您直接部署模板即可完成网关部署。</p></li><li><p>步骤四：安装阿里云复制服务</p><p>CDR 网关部署完成后，您可以从网关提供的链接下载阿里云复制服务（AReS）的安装包，并在应用服务器上完成安装。阿里云复制服务（AReS）会通过 CDR 网关将服务器实时复制到阿里云上。</p></li><li><p>步骤五：应用容灾</p><p>应用服务器成功安装 AReS 之后，混合云容灾服务控制台就可以进行所有的容灾作业了。您可以在控制台上启动容灾复制，进行容灾演练、故障切换等操作，也可以对所有的容灾业务进行监控。</p></li><li><p>回切至本地VMware</p><p>利用阿里云连续复制型容灾（CDR）服务，在本地虚拟机出现问题后把云上恢复出来的 ECS 回切至云下 VMware 环境或本地物理机。</p></li></ol><h5 id="步骤一：搭建云上专有网络"><a href="#步骤一：搭建云上专有网络" class="headerlink" title="步骤一：搭建云上专有网络"></a>步骤一：搭建云上专有网络</h5><p>搭建云上专有网络（VPC）是开始利用阿里云对企业核心业务进行容灾保护的第一步。搭建VPC只需要简单的几步，您就可以在云上拥有一个完全隔离的独占网络环境。</p><p>混合云容灾服务本质上就是将自建主数据中心内的服务器实时复制到云上一个用户专有的、安全的网络环境中。主数据中心发生重大故障时，所有的服务器可以在VPC内运行，让业务得以继续运行。</p><p><strong>三个因素</strong></p><p>搭建VPC时，您需要考虑选取哪一个阿里云地域作为容灾中心，数据中心与阿里云 VPC 之间使用哪一种网络连接，以及VPC使用哪个网段。<a href="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/6645052751/p33361.jpg"><img src="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/6645052751/p33361.jpg" alt="img"></a></p><p>如上图所示，我们可以基于三个因素来搭建VPC。</p><ul><li><p>阿里云地域的选择</p><p>阿里云的所有数据中心都拥有极为强大的基础设施。您只需根据实际情况，如物理距离要求（例如业务部门可能要求容灾中心距离主数据中心&gt;100KM），网络性能要求 （如延迟&lt;50ms)，网络成本限制（专线通常会因为距离增大而价格升高）等因素来选择合适的阿里云区域作为容灾目标区域。</p></li><li><p>数据中心与阿里云VPC的连接</p><p>用户自建主数据中心可以使用公网、VPN、或者专线与阿里云VPC之间的网络进行连接。</p><ul><li>公网 （普通企业宽带）：针对每日数据变化量不大，且主数据中心的系统无需频繁访问云上资源。阿里云加密的数据上行通道可以确保数据安全，同时压缩后的数据流可以确保公网承载较大的数据流。</li><li>VPN（阿里云VPN网关）：针对每日数据变化量不大，主数据中心需要随时连接阿里云VPC内的业务场景，例如主数据中心与阿里云上部署主从的域服务器，两个服务器之间需要长连接。</li><li>专线（高速通道）：针对数据量较大且应用较复杂的场景，通常需要根据每日数据变化量做预先规划。</li></ul></li><li><p>VPC网段</p><p>云上VPC网络环境下需要两个核心网段：</p><ul><li><strong>复制网络</strong>网段：承接从云下复制到云上的数据，可以是任意网段。</li><li><strong>恢复网络</strong>网段：用于运行容灾演练或故障切换时恢复出来的ECS。对于简单场景，恢复网络可以使用与源数据中心完全一致的网段。这样可以确保云上容灾恢复出来的服务器使用了与源站同样的IP，无需修改系统配置即可运行应用。</li></ul><p><strong>说明</strong> 复制网络和恢复网络所用的交换机须处于同一个可用区。</p><p>因此对于简单场景，我们建议创建一个完全覆盖源站网段的VPC，然后在这个VPC下创建一个与源站网段一致的交换机作为恢复网络的交换机，再创建一个与源站不同网段的交换机作为复制网络的交换机。</p></li></ul><p><strong>示例说明</strong></p><p>假设某个主站的基本情况如下：</p><ul><li>主站位于上海市，要求容灾中心距离主站至少100KM。</li><li>主站数据中心数据日变化量20GB。</li><li>主站服务器网段是10.0.2.0/24。</li></ul><p>鉴于以上主站的实际情况，并结合三个因素的综合分析，最终规划如下：</p><ul><li>选择距离主数据中心120KM的阿里云华东1（杭州）作为灾备中心。</li><li>因为业务数据日变化量不大，我们直接使用公网连接阿里云，不采用VPN或专线。</li><li>考虑本地主数据中心用了10.0.2.0/24网段，您可以：<ul><li>在阿里云上搭建一个10.0.0.0/8网段的VPC。</li><li>在这个VPC下搭建一个与源站网段完全一致的10.0.2.0/24网段的交换机，作为恢复网络交换机。</li><li>在这个VPC下再搭建一个10.0.3.0/24网段的交换机，作为复制网络交换机。</li></ul></li></ul><p>规划示意图如下：</p><p><a href="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/6645052751/p33460.jpg"><img src="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/6645052751/p33460.jpg" alt="img"></a></p><p><strong>操作步骤</strong></p><p>您可以执行以下步骤搭建符合上述示例场景下的VPC：</p><ol><li><p>登录<a href="https://vpc.console.aliyun.com/vpc/cn-hangzhou/vpcs">专有网络控制台</a>。</p></li><li><p>选择专有网络地域<strong>华东1（杭州）</strong>。</p></li><li><p>单击<strong>创建专有网络</strong>。</p></li><li><p>在<strong>创建专有网络</strong>页面，您可以创建专有网络和交换机。</p></li><li><img src="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/6645052751/p33473.png" alt="img" style="zoom:80%;" /><ul><li><p>在<strong>专有网络</strong>区域中，输入专有网络<strong>名称</strong>，<strong>IPv4网段</strong>选择<strong>10.0.0.0/8</strong>。</p></li><li><p>在交换机区域中，输入交换机名称，选择可用区，IPv4网段选择10.0.2.0/24，该交换机用于恢复网络。</p><p><strong>说明</strong> 一旦创建成功，网段不能修改。</p></li></ul></li><li><p>单击<strong>添加</strong>按钮，添加用于复制网络的交换机。</p></li><li><p>输入复制网络交换机的<strong>名称</strong>，选择<strong>可用区</strong>，<strong>IPv4网段</strong>选择<strong>10.0.3.0/24</strong> 。</p><p><strong>说明</strong> 确保与恢复网络交换机位于同一个可用区。</p></li><li><p>单击<strong>确定</strong>。</p></li></ol><h5 id="步骤二：创建容灾站点对"><a href="#步骤二：创建容灾站点对" class="headerlink" title="步骤二：创建容灾站点对"></a>步骤二：创建容灾站点对</h5><p>云上专有网络搭建完成后，您需要将自建数据中心与云上的专有网络配对，即创建容灾站点对。</p><p><strong>背景信息</strong></p><p>创建容灾站点对前，您需要有搭建完成的云上专有网络。</p><p><strong>操作步骤</strong></p><ol><li><p>登录<a href="https://hdr.console.aliyun.com/">混合云容灾管理控制台</a>。</p></li><li><p>在<strong>概览</strong>页，单击<strong>创建容灾站点对</strong>，选择<strong>连续复制型容灾</strong>。</p></li><li><p>在<strong>创建连续复制型容灾站点对</strong>页面，填写以下各项参数。</p><img src="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/4690579651/p54422.jpg" alt="site pair" style="zoom:80%;" /><ul><li><strong>类型</strong>：您可以选择<strong>IDC容灾到云</strong>、<strong>区域容灾到区域</strong>及<strong>可用区容灾到可用区</strong>。</li><li><strong>名称</strong>：给主站起一个可辨识的名称。</li><li><strong>区域</strong>：下拉选择<a href="https://help.aliyun.com/document_detail/92681.html#concept-92681-zh">步骤一：搭建云上专有网络</a>时所选的区域。</li><li><strong>VPC</strong>：下拉选择该区域内已创建的 VPC。</li></ul></li><li><p>单击<strong>创建</strong>。</p><p>容灾站点对创建完成后，您可以在<strong>概览</strong>页面的<strong>容灾站点对列表</strong>中找到已创建的容灾站点对。<br><a href="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/5690579651/p54428.jpg"><img src="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/5690579651/p54428.jpg" alt="Sitepair2"></a></p><ul><li>如配置有误，您可以单击该容灾站点对右侧对应的<a href="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/5690579651/p33596.png"><img src="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/5690579651/p33596.png" alt="img"></a>按钮删除已创建的容灾站点对。</li><li>单击<a href="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/5690579651/p54501.jpg"><img src="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/5690579651/p54501.jpg" alt="img"></a>查看网络流量情况。<br><a href="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/5690579651/p54503.jpg"><img src="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/5690579651/p54503.jpg" alt="img"></a></li></ul></li></ol><h5 id="步骤三：部署CDR网关"><a href="#步骤三：部署CDR网关" class="headerlink" title="步骤三：部署CDR网关"></a>步骤三：部署CDR网关</h5><p>当容灾站点创建完成后，您需要在数据中心内部署一台连续复制型容灾（CDR） 网关。CDR 网关用来聚合所有来自被容灾保护的服务器上的数据，并将其压缩加密后安全高效地上传到阿里云上。</p><p><strong>说明</strong></p><ul><li>CDR 网关需要打开公网出方向的 1883 和 443 端口，用于和云上控制台通信以及数据传输。</li><li>CDR 网关通过 9090 和 9095 端口向被保护服务器提供服务，8080 端口用于通过浏览器访问来激活网关。</li><li>客户端程序通过 9080 端口接受 CDR 网关的指令。</li></ul><p>因此您需要合理设置防火墙，保证被保护服务器可以连通网关的 9090 和 9095 端口，并且被保护服务器的 9080 端口允许 CDR 网关访问。</p><p><strong>步骤1：创建并下载网关镜像</strong></p><ol><li><p>登录<a href="https://hdr.console.aliyun.com/">混合云容灾控制台</a>。</p></li><li><p>单击已创建的连续复制型容灾站点对。</p></li><li><p>单击容灾网关下的<a href="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/1289702851/p54432.jpg"><img src="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/1289702851/p54432.jpg" alt="img"></a>创建网关。</p></li><li><p>在<strong>创建主站容灾网关</strong>页面，填写<strong>名称</strong>，部署环境选择<strong>Apsara DR100</strong>、<strong>Apsara DR200</strong>、<strong>VMware</strong>或<strong>Hyper-V</strong>。<a href="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/1289702851/p54433.jpg"><img src="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/1289702851/p54433.jpg" alt="img" style="zoom: 67%;" /></a></p></li><li><p>单击<strong>创建</strong>。</p></li><li><p>在<strong>创建主站容灾网关</strong>页面，单击<strong>下载容灾网关镜像</strong>。<a href="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/1289702851/p54435.jpg"><img src="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/1289702851/p54435.jpg" alt="img" style="zoom:67%;" /></a></p><p>您也可以单击已创建容灾网关右侧对应的*<strong>*<a href="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/1289702851/p54437.jpg"><img src="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/1289702851/p54437.jpg" alt="img"></a>\</strong> &gt; *<em>下载容灾网关镜像***</em>。<a href="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/1289702851/p54438.jpg"><img src="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/1289702851/p54438.jpg" alt="img" style="zoom:67%;" /></a>。</p></li></ol><p><strong>步骤2：部署网关镜像</strong></p><p>本节介绍如何在 <a href="https://help.aliyun.com/document_detail/92482.html?spm=a2c4g.11186623.2.17.6c5a7e772BfFFm#VMware">VMware</a> 以及 <a href="https://help.aliyun.com/document_detail/92482.html?spm=a2c4g.11186623.2.17.6c5a7e772BfFFm#Hyper-V">Hyper-V</a> 中部署网关镜像。</p><ul><li><p>在 VMware 中部署 CDR 网关</p><p>OVA 格式的网关镜像下载完成后，您就可以在 VMware vSphere 平台上部署 CDR 网关了。CDR VMWare 镜像可以在 VMWare 5.5 - 6.5 上部署。</p><p><strong>注意</strong></p><ul><li>强烈建议将 CDR 网关部署在已配置了高可用（HA）的 vSphere 集群上，确保 CDR 网关的高可用性。</li><li>OVA 仅支持通过 vCenter 的网页客户端（Web Client）来部署，通过 vCenter 的 C# 客户端或者 Esxi UI 部署都会使网关无法工作。</li></ul><p><a href="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/2289702851/p33720.jpg"><img src="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/2289702851/p33720.jpg" alt="img" style="zoom: 33%;" /></a></p><p>在 VMware vSphere 平台上部署 CDR 网关操作步骤如下：</p><ol><li><p>用管理员身份登录 vSphere 网页客户端后，vSphere 集群上单击右键选择<strong>部署OVF模板…</strong>。<a href="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/2289702851/p33721.png"><img src="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/2289702851/p33721.png" alt="img" style="zoom: 67%;" /></a></p></li><li><p>按照 OVF 部署向导，在<strong>选择模板</strong>页面，单击<strong>浏览</strong>选择下载好的网关镜像 OVA 文件。<a href="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/2289702851/p33722.jpg"><img src="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/2289702851/p33722.jpg" alt="img" style="zoom:50%;" /></a></p></li><li><p>在<strong>选择名称和位置</strong>页面，输入<strong>名称</strong>，并选择镜像部署位置，通常只需要选择到集群级别，或者选择文件夹。<a href="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/2289702851/p33723.jpg"><img src="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/2289702851/p33723.jpg" alt="img"></a></p></li><li><p>在<strong>选择资源</strong>页面，选择 CDR 网关部署的目标资源池。<a href="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/3289702851/p33724.png"><img src="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/3289702851/p33724.png" alt="img"></a></p></li><li><p>在<strong>查看详细信息</strong>页面，查看 CDR 网关部署详细信息。<a href="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/3289702851/p33725.jpg"><img src="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/3289702851/p33725.jpg" alt="img"></a></p></li><li><p>在选择存储页面，选择部署网关的数据存储。</p><p><img src="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/3289702851/p33726.png" alt="img"></p><p><strong>说明</strong> 数据存储建议选择有 RAID 配置的共享存储，以确保网关的稳定性和高可用性。</p></li><li><p>在自定义模板页面，配置网关网络信息。</p><p><img src="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/3289702851/p33727.jpg" alt="img"></p><p><strong>说明</strong> 网关子网掩码要使用 CIDR 格式，比如 255.255.255.0 的子网掩码，您应当输入24。</p><p>管理员用户设置主要用于后续登录 CDR 虚拟机做内部网络等配置。</p></li><li><p>确认网关部署信息，单击<strong>完成</strong>。<a href="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/4289702851/p33734.png"><img src="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/4289702851/p33734.png" alt="img"></a></p></li><li><p>待部署完成后，您可以在 vSphere 的虚机列表中看到已部署完成的虚拟机。<a href="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/4289702851/p33737.jpg"><img src="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/4289702851/p33737.jpg" alt="img" style="zoom:50%;" /></a></p></li><li><p>（可选，建议配置）增强虚机高可用性</p><p>在配置了高可用（HA) vSphere 集群上，如果 CDR 网关所在的 Esxi 宕机，网关会在同集群其他 Esxi 服务器上运行起来，宕机时间取决于 vSphere 集群的 HA 配置。建议您提高网关虚机重启优先级，以尽量缩短虚机启动时间。</p><p>对于 vSphere 6.5 以前的版本，您可以参考<a href="https://pubs.vmware.com/vsphere-50/topic/com.vmware.vsphere.avail.doc_50/GUID-F9C1EBCF-87C5-4FF2-8149-19D2ACF09890.html">vSphere文档</a>进行配置。</p><p>对于 vSphere 6.5 以上版本，您可以按照以下步骤增强虚机高可用性：</p><ol><li>在 CDR 网关所在集群的<strong>配置</strong>页面，单击<strong>虚拟机替代项</strong>，然后单击<strong>添加</strong>。<a href="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/4289702851/p33739.jpg"><img src="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/4289702851/p33739.jpg" alt="img"></a></li><li>在<strong>添加虚拟机替代项</strong>页面，单击图标<a href="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/4289702851/p33740.jpg"><img src="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/4289702851/p33740.jpg" alt="img"></a>选择虚拟机。<a href="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/4289702851/p33745.jpg"><img src="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/4289702851/p33745.jpg" alt="img"></a></li><li>在选择虚拟机的<strong>筛选</strong>页面，勾选本示例中的虚拟机<strong>Aliyun-BCDR-Server-1.0.0</strong>。<a href="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/5289702851/p33747.jpg"><img src="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/5289702851/p33747.jpg" alt="img"></a></li><li><strong>虚拟机重新启动优先级</strong>一栏，选择<strong>最高</strong>。<a href="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/5289702851/p33748.jpg"><img src="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/5289702851/p33748.jpg" alt="img"></a></li></ol><p>完成以上步骤后，一旦 CDR 网关虚机出现宕机，vSphere 将会尽快将网关在其他 Esxi 服务器上重启，让容灾复制继续进行。</p></li></ol></li><li><p>在 Hyper-V 中部署 CDR 网关</p><p><strong>说明</strong> 建议将 CDR 网关部署在已配置了高可用的 (HA) 的 Hyper-v 集群上，确保 CDR 的高可用性。</p><p>在 Hyper-V 中部署 CDR 网关操作步骤如下：</p><ol><li><p>解压上述步骤中创建的 CDR 网关镜像。<a href="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/5289702851/p40759.png"><img src="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/5289702851/p40759.png" alt="img"></a></p></li><li><p>打开 Hyper-V 管理器，右键选择<strong>导入虚拟机</strong>。<a href="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/5289702851/p40760.png"><img src="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/5289702851/p40760.png" alt="img"></a></p></li><li><p>在<strong>定位文件夹</strong>页签，选择第 1 步已解压的文件夹。<a href="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/5289702851/p40768.png"><img src="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/5289702851/p40768.png" alt="img"></a></p></li><li><p>在<strong>选择导入类型</strong>页面，勾选<strong>还原虚拟机（使用现有的唯一 ID）</strong>。<a href="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/6289702851/p40770.png"><img src="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/6289702851/p40770.png" alt="img"></a></p></li><li><p>在<strong>选择目标</strong>页面，选择使用默认文件夹或创建新的文件夹。<a href="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/6289702851/p40783.png"><img src="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/6289702851/p40783.png" alt="img"></a></p></li><li><p>在选择存储文件夹页面，选择虚拟磁盘存放路径。</p><p><strong>说明</strong> 请根据实际情况选择剩余空间容量较大的分区。</p><p><img src="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/6289702851/p40786.png" alt="img"></p></li><li><p>在<strong>摘要</strong>页面，待导入向导完成后，单击<strong>完成</strong>。<a href="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/6289702851/p40787.png"><img src="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/6289702851/p40787.png" alt="img"></a></p></li><li><p>右击虚拟机选择设置，单击网络适配器选择虚拟交换机。</p><p><strong>说明</strong> CDR 网关默认配置的虚拟交换机导入完成后会失效，请新建一个虚拟交换机或者使用可用的虚拟交换机。</p><p><img src="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/6289702851/p40790.png" alt="img"></p></li><li><p>指定网络适配器后单击<strong>确定</strong>。<a href="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/7289702851/p40792.png"><img src="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/7289702851/p40792.png" alt="img"></a></p></li><li><p>单击<strong>虚拟交换机管理器</strong>配置虚拟交换机。</p></li><li><p><a href="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/7289702851/p40794.png"><img src="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/7289702851/p40794.png" alt="img"></a></p></li><li><p>选择虚拟机配置时新建的虚拟交换机，选择需要共享网络的物理网卡，并勾选<strong>允许管理操作系统共享此网络适配器</strong>。</p><p><img src="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/7289702851/p40795.png" alt="img"></p></li></ol></li></ul><p><strong>步骤3：配置网关网络与时间</strong></p><p><strong>注意</strong> VMWare 平台上用 OVA 部署的网关在部署过程中已经完成了网络配置。如果您不需要对网络配置进行修改，请直接执行<a href="https://help.aliyun.com/document_detail/92482.html?spm=a2c4g.11186623.2.17.6c5a7e772BfFFm#activate">激活网关</a>中的步骤。</p><p>网关虚机或混合云灾备一体机部署好之后，就可以做基本的网络配置了。CDR 网关网络既要能够连接容灾保护的服务器，还要允许通过公网或者专线连接至阿里云。</p><p>对于虚拟化部署的环境，您可以直接在虚拟化平台控制台中进入虚机界面。如果是混合云灾备一体机，则可以直接从本地连接显示器登录服务器。</p><p>配置网关网络与时间步骤如下：</p><ol><li><p>使用默认的用户名root、密码Aliyun!23登录虚拟化平台控制台。</p></li><li><p>在配置页面，单击<strong>NetWork</strong>选项，根据您网络的实际情况，配置 IP 地址、子网掩码、网关、DNS 服务器。</p><p><strong>说明</strong> 其中，子网掩码网需使用CIDR格式 。比如，子网掩码为255.255.255.0，您应当输入24。</p></li><li><p>单击<strong>Date/Time</strong>，将 NTP Server 设置为阿里云 NTP Server，即ntp.aliyun.com 。</p></li></ol><p><strong>步骤4：激活网关</strong></p><p>激活网关是为了让网关与阿里云正式建立连接，并且准备好接收容灾复制数据流。</p><p>网关网络与时间配置完成后，您可以按照如下步骤激活网关：</p><ol><li><p>在<strong>容灾中心</strong>的<strong>站点对信息</strong>页签下，单击激活图标<a href="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/7289702851/p54514.jpg"><img src="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/7289702851/p54514.jpg" alt="img"></a>。<a href="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/8289702851/p54513.jpg"><img src="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/8289702851/p54513.jpg" alt="img" style="zoom: 50%;" /></a></p><p><strong>说明</strong> 激活码的有效时间为 15 分钟。</p></li><li><p>登录连续复制型容灾网关注册页面，地址格式为：http://网关IP:8080。</p><p>各参数配置如下：</p><ul><li><strong>AccessKey</strong>和<strong>AccessKey Secret</strong>：如果使用的是RAM子账号的AK，请确保RAM子账号具有<code>AliyunHDRFullAccess</code>、<code>AliyunVPCReadOnlyAccess</code>以及<code>AliyunECSReadOnlyAccess</code>的权限。</li><li><strong>激活码</strong>：填写步骤一中获取的激活码。</li><li><strong>密码</strong>：密码用于后续需要做容灾保护的服务器与网关建立安全连接，您可以按照自己的要求指定密码。</li></ul></li><li><p>单击<strong>确认</strong>。</p></li></ol><p>CDR 网关激活完成后，您需要在关键业务服务器上安装阿里云复制服务（Aliyun Replication Service, AReS），将服务器复制到阿里云。</p><p><strong>相关操作</strong></p><p>除下载容灾网关镜像外，您还可以对容灾网关设置限速、重置密码、删除网关及收集支持信息。<a href="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/8289702851/p54519.jpg"><img src="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/8289702851/p54519.jpg" alt="img" style="zoom:50%;" /></a></p><ul><li><p>设置限速：如果您想要设置网关限速，请勾选启用限速，单击添加，并设置启用限速的起始时间、结束时间及网络速度</p><p>，然后单击确认。如果想要取消网关限速，请单击操作栏下的删除图标。<a href="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/8289702851/p54526.jpg"><img src="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/8289702851/p54526.jpg" alt="img" style="zoom: 67%;" /></a></p></li><li><p><strong>重置密码</strong>：您可以为容灾网关重置密码。</p></li><li><p><strong>删除网关</strong>：如果您不再需要保留此网关，可以选择删除网关。</p></li><li><p><strong>收集支持信息</strong>：容灾网关的支持信息仅涉及容灾操作中容灾服务生成的日志，用于定位和解决问题。收集容灾网关的支持信息后，您可以提交工单描述遇到的问题，工单中注明容灾网关的ID。</p></li></ul><h5 id="步骤四：安装阿里云复制服务"><a href="#步骤四：安装阿里云复制服务" class="headerlink" title="步骤四：安装阿里云复制服务"></a>步骤四：安装阿里云复制服务</h5><p>本文介绍如何在 Windows 及 Linux 系统中安装阿里云复制服务（Aliyun Replication Service, AReS）。</p><p>CDR 网关激活完成后，您需要在做容灾保护的服务器上安装阿里云复制服务（Aliyun Replication Service, AReS），将服务器容灾复制到阿里云。</p><p>在 Windows 或 Linux 系统中安装 AReS 前，您需要按照如下步骤下载对应的安装包：</p><ol><li><p>登录连续复制型容灾网关页面，地址格式为：http://网关IP:8080。</p></li><li><p>根据需要保护的机器版本下载对应的安装包。</p><p><strong>说明</strong> Windows 操作系统可能警告 exe 未经验证，单击<strong>继续下载</strong>即可。</p></li></ol><p><strong>在Windows中安装AReS</strong></p><p>Windows 安装包下载完成后，请按照如下步骤安装 AReS：</p><ol><li><p>双击 ali-replication-service 安装包。</p></li><li><p>在<strong>选择语言</strong>窗口中，安装时使用语言选择<strong>中文（简体）</strong>或 <strong>English</strong>，单击<strong>确定</strong>。<a href="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/6907305851/p33670.png"><img src="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/6907305851/p33670.png" alt="img"></a></p></li><li><p>单击<strong>下一步</strong>。<a href="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/6907305851/p33672.png"><img src="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/6907305851/p33672.png" alt="img"></a></p></li><li><p>在<strong>连续复制型容灾网关（CDR网关）信息</strong>页面，输入<strong>容灾网关IP地址</strong>和<strong>容灾网关密码</strong>，单击<strong>下一步</strong>。</p></li><li><p>选择安装路径，单击<strong>下一步</strong>。<a href="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/6907305851/p33676.jpg"><img src="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/6907305851/p33676.jpg" alt="img"></a></p></li><li><p>单击<strong>安装</strong>。</p></li><li><p>单击<strong>立即重新启动</strong>。<a href="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/6907305851/p33678.jpg"><img src="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/6907305851/p33678.jpg" alt="img"></a></p><p>重启完成后，即阿里云复制服务（AReS）安装完成。</p></li><li><p>您可以在<a href="https://hdr.console.aliyun.com/">混合云容灾管理控制台</a>的<strong>容灾中心</strong>下的<strong>受保护服务器</strong>页签，找到已安装了 AReS 的服务器，且显示为<strong>已注册</strong>状态。<a href="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/6907305851/p33683.jpg"><img src="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/6907305851/p33683.jpg" alt="img"></a></p></li></ol><p><strong>在Linux中安装AReS</strong></p><p>请按照如下步骤在 Linux 系统中安装 AReS：</p><ol><li><p>在被保护的机器中下载 Linux 安装包（wget 或者 curl）。</p><p>以 curl 为例，执行命令<code>curl -O http://[网关ip]:8080/static/installer/ali-replication-service.sh</code>。<a href="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/7907305851/p47201.tif"><img src="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/7907305851/p47201.tif" alt="img"></a></p></li><li><p>执行命令<code>Chmod +x ali-replication-service.sh</code>为下载的安装包添加执行权限。</p></li><li><p>执行命令<code>./ali-replication-service.sh</code>。<a href="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/7907305851/p47202.tif"><img src="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/7907305851/p47202.tif" alt="img"></a></p></li><li><p>输入 BCRD 网关 IP 和密码。</p><p><strong>警告</strong> 该过程中请勿终止程序。</p><p><a href="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/7907305851/p47207.jpg"><img src="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/7907305851/p47207.jpg" alt="img"></a></p></li><li><p>您可以在<a href="https://hdr.console.aliyun.com/">混合云容灾管理控制台</a>的<strong>容灾中心</strong>下的<strong>受保护服务器</strong>页签，找到已安装了 AReS 的服务器，且显示为<strong>已注册</strong>状态。<a href="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/7907305851/p47209.jpg"><img src="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/7907305851/p47209.jpg" alt="img"></a></p></li></ol><p><strong>（可选）卸载AReS</strong></p><p>以下提供了在 Windows 及 Linux 系统中卸载 AReS 的方法。</p><ul><li><p>Windows 系统中卸载 AReS</p><ol><li>打开控制面板，右键选择<strong>卸载【阿里云复制服务（AReS）】</strong>。</li><li>在阿里云复制服务（AReS）卸载页面，选择<strong>是</strong>以删除阿里云复制服务（AReS）及其所有组件。<a href="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/7907305851/p57684.png"><img src="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/7907305851/p57684.png" alt="img"></a></li><li>阿里云复制服务（AReS）卸载完成后，选择<strong>是</strong>以重启电脑。<a href="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/7907305851/p57686.png"><img src="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/7907305851/p57686.png" alt="img"></a></li></ol></li><li><p>Linux 系统中卸载 AReS</p><p>在Linux系统中执行命令<code>./ali - replication - server_27.sh -u</code>以下载 AReS。<a href="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/7907305851/p57690.png"><img src="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/7907305851/p57690.png" alt="img"></a></p></li></ul><h5 id="步骤五：应用容灾"><a href="#步骤五：应用容灾" class="headerlink" title="步骤五：应用容灾"></a>步骤五：应用容灾</h5><p>当被保护的服务器完成阿里云复制服务（AReS）安装并重启后，您就可以对受保护的服务器启动、停止容灾复制、故障切换、容灾演练等一系列的应用容灾操作了。</p><p>通常情况下，应用容灾的流程如下：</p><ol><li>启动容灾复制，将服务器复制到云上，并维持实时复制。</li><li>按照您指定的具体策略，定期对服务器进行容灾演练，确保服务器能够在阿里云上正常拉起。</li><li>当本地自建数据中心出现重大故障时，对服务器进行故障切换，确保在阿里云上正式运行业务。</li><li>本机出现故障后，在对端（云上）拉起，待本地环境恢复后再将其恢复到本地。</li></ol><p><strong>启动容灾复制</strong></p><p>容灾的第一步是把应用服务器整机复制到阿里云，并且能够实时复制增量。</p><ol><li><p>登录<a href="https://hdr.console.aliyun.com/">混合云容灾控制台</a>。</p></li><li><p>在连续复制型容灾的<strong>受保护服务器</strong>页签中，单击要启动容灾复制的服务器对应的<strong>操作</strong>按钮，选择*<strong>*更多\</strong> &gt; *<em>故障切换*</em> &gt; *<em>启动复制***</em>。</p></li><li><p>在<strong>启动复制</strong>对话框中，分别选择<strong>恢复点策略</strong>，是否<strong>使用SSD</strong>、根据<a href="https://help.aliyun.com/document_detail/92681.html#section-wzp-bnw-yfb">搭建云上专有网络</a>文档说明，选择用于<strong>复制网络</strong>和<strong>恢复网络</strong>的交换机。<a href="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/5144725751/p54552.jpg"><img src="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/5144725751/p54552.jpg" alt="img"></a></p></li><li><p>单击<strong>启动</strong>。</p><p>此时，容灾复制会先后进入<strong>启动复制</strong>、<strong>全量复制</strong>、<strong>实时复制中</strong>三个阶段。<a href="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/5144725751/p33816.png"><img src="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/5144725751/p33816.png" alt="img"></a></p><ul><li><strong>启动复制</strong>：混合云容灾服务正在扫描系统数据，评估总体数据量，这一阶段通常会持续几分钟。</li><li><strong>全量复制</strong>：混合云容灾服务正在把整台服务器的有效数据传输到阿里云，这一阶段所用时间取决于服务器数据量、网络带宽等因素。控制台进度条将会展示复制进度。</li><li><strong>实时复制中</strong>：全量复制完成后，阿里云上已经复制了您的全量数据，然后 AReS 将会在服务器上监视所有对磁盘的写操作，并持续地实时复制到阿里云。</li></ul></li></ol><p><strong>容灾演练</strong></p><p>一旦进入实时复制状态，您就可以对服务器进行容灾演练操作了。</p><p>容灾演练将被容灾保护的服务器在云上拉起并验证应用正确性，是容灾流程整体中及其重要的一环，它的核心意义在于：</p><ul><li>方便地验证复制到阿里云上的应用可以在云上正常拉起。</li><li>确保操作人员熟悉容灾恢复流程，确保在本地真正发生故障时，操作人员可以顺畅地进行容灾切换。</li></ul><p>容灾演练操作步骤如下：</p><ol><li><p>在连续复制型容灾的<strong>受保护服务器</strong>页签中，单击要启动容灾复制的服务器对应的操作栏下的<strong>容灾演练</strong>。</p></li><li><p>在<strong>容灾演练</strong>对话框中，填写<strong>CPU</strong>、<strong>内存</strong>信息、选择<strong>IP地址</strong>、是否<strong>使用SSD</strong>、选择<strong>恢复点</strong>、<strong>弹性公网IP</strong>、<strong>切换后执行脚本</strong>。<a href="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/6144725751/p54582.jpg"><img src="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/6144725751/p54582.jpg" alt="img"></a></p><p><strong>说明</strong> 混合云容灾服务会自动为每个服务器保留最近 24 小时的 24 个恢复点。</p></li><li><p>单击<strong>启动</strong>。</p><p>此时，阿里云会在后台基于用户选定的时间点将服务器拉起。后台容灾演练过程中，实时数据复制不受影响。<a href="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/6144725751/p54596.jpg"><img src="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/6144725751/p54596.jpg" alt="img"></a></p></li><li><p>几分钟后，您会看到容灾演练完成，单击<strong>容灾演练信息</strong>下的链接，验证数据与应用。<a href="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/6144725751/p54597.jpg"><img src="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/6144725751/p54597.jpg" alt="img"></a></p></li><li><p>验证完成后，您需要单击该服务器对应的操作栏下的<strong>清空演练环境</strong>，此时第4步恢复出来的ECS就会被删除。</p><p><strong>说明</strong> 容灾演练恢复出来的ECS验证完成后，建议尽快清空演练环境，以降低费用支出。</p></li></ol><p><strong>故障切换</strong></p><p>定期的容灾演练保证了您的业务可以随时在云上拉起。而当您的主站发生重大故障，需要在云上马上重启核心业务时，就需要进行故障切换操作了。</p><p><strong>警告</strong> 故障切换操作适用于云下环境已经出现严重故障的的情形，进行该操作会停掉实时复制流程。您需要重新启动复制，并完成一次全量复制才能对云下服务器继续进行容灾保护。因此除非确实有故障切换的必要，否则不要进行此操作。</p><p>故障切换步骤如下：</p><ol><li><p>在连续复制型容灾的<strong>受保护服务器</strong>页签中，单击要启动容灾复制的服务器对应的操作栏下的*<strong>*更多\</strong> &gt; *<em>故障切换*</em> &gt; *<em>故障切换***</em>。</p></li><li><p>在<strong>故障切换</strong>对话框中，填写<strong>CPU</strong>、<strong>内存</strong>信息、选择<strong>IP地址</strong>、是否<strong>使用SSD</strong>、选择<strong>恢复点</strong>、<strong>弹性公网IP</strong>、<strong>切换后执行脚本</strong>。<a href="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/6144725751/p54598.jpg"><img src="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/6144725751/p54598.jpg" alt="img"></a></p><p><strong>说明</strong> <strong>当前时间</strong>恢复点只能使用一次。</p></li><li><p>单击<strong>启动</strong>。</p></li><li><p>故障切换完成后，您可以在单击<strong>故障切换/故障恢复信息</strong>下的链接，检查数据和应用。<a href="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/6144725751/p54601.jpg"><img src="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/6144725751/p54601.jpg" alt="img"></a></p><ul><li><p>如果检查后发现当前时间点的应用数据没有被污染，可以直接单击</p><p><strong>更多</strong> &gt; <strong>故障切换</strong> &gt; <strong>确认故障切换</strong></p><p>操作。</p><p><strong>说明</strong> 在故障切换或者切换恢复点完成，并且已经确认阿里云上恢复出的应用已经接管了业务的情况下，完成故障切换操作是为了清理容灾复制在云上占用的资源，节约资源使用。</p></li><li><p>如果检查后发现当前时间点的应用状态不符合要求，比如数据库一致性问题，或者源端被污染的数据已经被同步到云上，请在确认故障切换前，单击*<strong>*更多\</strong> &gt; *<em>故障切换*</em> &gt; *<em>切换恢复点***</em>操作。</p></li></ul></li><li><p>您需要单击*<strong>*更多\</strong> &gt; *<em>服务器操作*</em> &gt; *<em>注销***</em>。</p><p>故障切换完成后，云上已经接管业务，被切换的服务器已经不需要进行复制，因此可以直接注销服务器。待云下环境重建后，再重新安装AReS服务，并配置容灾复制。</p><p><strong>说明</strong> 切换恢复点操作与故障切换操作类似，仅需选择更早的恢复点即可。</p></li></ol><p><strong>故障恢复</strong></p><p>本机出现故障后，在对端（云上）拉起。待本地环境恢复后再将其恢复到本地的过程。具体步骤如下：</p><ol><li><p>单击添加图标添加计算平台。<a href="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/6144725751/p54629.jpg"><img src="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/6144725751/p54629.jpg" alt="img"></a></p></li><li><p>在<strong>添加计算平台</strong>页面，填写计算平台<strong>名称</strong>、选择<strong>类型</strong>、填写<strong>IP地址</strong>、<strong>用户名</strong>和<strong>密码</strong>。<a href="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/6144725751/p54633.jpg"><img src="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/6144725751/p54633.jpg" alt="img"></a></p></li><li><p>单击<strong>创建</strong>。</p></li><li><p>在连续复制型容灾的<strong>受保护服务器</strong>页签中，单击要启动故障回切的服务器对应的操作栏下的*<strong>*更多\</strong> &gt; *<em>故障恢复*</em> &gt; *<em>反向注册***</em>。</p></li><li><p>在弹出的<strong>反向注册</strong>页面中，单击<strong>确认</strong>。</p><p>此时，服务器状态显示<strong>反向注册中</strong>，随后进入<strong>已反向初始化</strong>。</p></li><li><p>单击*<strong>*更多\</strong> &gt; *<em>故障恢复*</em> &gt; *<em>启动反向复制***</em>。</p></li><li><p>在<strong>启动反向复制</strong>页面，选择<strong>计算平台</strong>，单击<strong>编辑</strong>选择<strong>复制位置</strong>、<strong>计算资源</strong>、<strong>复制存储</strong>及<strong>复制网络</strong>，然后勾选<strong>使用DHCP</strong>。<a href="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/7144725751/p54643.jpg"><img src="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/7144725751/p54643.jpg" alt="img"></a></p><p>如果不勾选<strong>使用DHCP</strong>，您还需要手动填写<strong>复制IP地址**</strong>复制子网掩码<strong>、</strong>复制DNS<strong>及</strong>复制网关**信息。<a href="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/7144725751/p54650.jpg"><img src="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/7144725751/p54650.jpg" alt="img"></a></p></li><li><p>单击<strong>启动</strong>。</p><p>此时，服务器状态显示<strong>启动反向复制</strong>，随后进入<strong>反向实时复制中</strong>。</p><p>如果想要停止服务器的反向复制，请单击*<strong>*更多\</strong> &gt; *<em>故障恢复*</em> &gt; *<em>停止反向复制***</em>。</p><p>反向复制将云上数据复制到线下环境，完成后单击*<strong>*更多\</strong> &gt; *<em>故障恢复*</em> &gt; *<em>故障恢复***</em>启动线下已恢复服务器。</p></li></ol><p><strong>相关操作</strong></p><p>在<strong>受保护服务器</strong>页签，单击<strong>设置可见列</strong>后，勾选所有或部分可见列选项后单击<strong>确认</strong>，查看服务器ID、RPO、服务器状态等信息。<a href="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/7144725751/p54576.jpg"><img src="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/7144725751/p54576.jpg" alt="img"></a></p><p>在<strong>受保护服务器</strong>页签，单击操作栏下的*<strong>*更多\</strong> &gt; *<em>收集支持信息***</em>查看被保护服务器的支持信息仅涉及容灾操作中容灾服务生成的日志，仅用于定位和解决问题。收集被保护的服务器支持信息后，您可以提交工单描述遇到的问题，工单中注明容灾网关的ID。</p><h5 id="步骤六：容灾回切"><a href="#步骤六：容灾回切" class="headerlink" title="步骤六：容灾回切"></a>步骤六：容灾回切</h5><p><strong>1、回切至本地物理机</strong></p><p>本文主要介绍如何利用阿里云连续复制型容灾（CDR）服务，在本地虚拟机出现问题后把云上恢复出来的ECS回切到用户本地数据中心的物理服务器上。</p><p><strong>背景介绍</strong></p><p>目前阿里云的混合云容灾服务对本地的数据中心做保护，并实现在本地虚拟机出现故障的时候以秒级RPO，分钟级RTO在阿里云ECS上进行恢复。但是对于完整的容灾场景，还要求在本地虚拟机出现问题后，可以选择云上恢复出来的ECS回切到用户本地数据中心的物理服务器上。</p><p><strong>准备工作</strong></p><p>您需要<a href="https://help.aliyun.com/document_detail/92482.html">部署BCDR网关</a>，然后在被保护的Windows服务器上<a href="https://help.aliyun.com/document_detail/92483.html">安装阿里云复制服务</a>，并在<a href="https://hdr.console.aliyun.com/">混合云容灾管理控制台</a>的容灾中心的<strong>受保护服务器</strong>页签，选择*<strong>*更多\</strong> &gt; *<em>启动复制***</em>。<br><a href="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/0790579651/p50828.png"><img src="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/0790579651/p50828.png" alt="img"></a></p><p><strong>启动云上恢复</strong></p><p>请按如下步骤启动云上恢复：</p><ol><li><p>服务器进入实时复制状态后，您可以直接关闭被保护服务器的电源，在<a href="https://hdr.console.aliyun.com/">混合云容灾管理控制台</a>上查看到被保护服务器进入异常状态。<br><a href="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/0790579651/p46867.png"><img src="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/0790579651/p46867.png" alt="img"></a></p></li><li><p>单击*<strong>*更多\</strong> &gt; *<em>故障切换***</em>。<br><a href="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/0790579651/p46875.jpg"><img src="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/0790579651/p46875.jpg" alt="img"></a></p></li><li><p>在<strong>故障切换</strong>对话框，<strong>IP地址</strong>选择<strong>保留当前IP</strong>，<strong>恢复点</strong>保留<strong>当前时间</strong>的默认选项。<br><a href="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/0790579651/p63236.jpg"><img src="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/0790579651/p63236.jpg" alt="img"></a></p><p>等待几分钟后，可以看到恢复的ECS已被成功拉起。您可以通过单击下图链接来查看机器的状态。<br><a href="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/1790579651/p46881.png"><img src="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/1790579651/p46881.png" alt="img"></a></p></li><li><p>在弹出的<strong>完成故障切换</strong>对话框中，单击<strong>确定</strong>。<br><a href="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/1790579651/p46886.png"><img src="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/1790579651/p46886.png" alt="img"></a></p></li></ol><p><strong>本地恢复</strong></p><p>目前仅支持本地磁盘，暂不支持FC共享存储、iSCSI存储、动态磁盘、UEFI启动的系统等物理机存储类型 。</p><ol><li><p>准备工作</p><ul><li><p>由于物理机的特殊性，目前仅支持恢复到原来的物理机（磁盘型号，大小，顺序务必要保持一致）。</p></li><li><p>请务必在准备本地恢复前，检查ECS上恢复机器的磁盘及分区（通过磁盘管理），如果发现分区大小大于物理机上的磁盘大小，请参考文末<a href="https://help.aliyun.com/document_detail/124160.html?spm=a2c4g.11186623.2.27.1ade7a2dyzTbMp#appendix">附录</a>手动收缩分区。</p></li><li><p>ECS限制每块磁盘的大小必须是整数GB。</p><p><strong>说明</strong> 当您把复制的物理机从云上拉起的时：</p><ul><li>如果包含非整数GB的磁盘，我们会自动帮您扩充磁盘大小至整数GB（&lt;1GB，比如100.3GB会扩充至101GB）。</li><li>如果扩充的是包含系统分区的磁盘，那么扩充的这部分空间会被ECS自动填充给系统分区，这样在恢复到本地的物理机的时候可能会出现分区越界的问题。</li><li>如果系统分区相对源端机器被扩容过，将会收缩相应的空间，保证和源端机器保持一致。</li></ul></li></ul></li><li><p>反向注册</p><p>确认云上恢复的ECS可以正常回切至本地环境后，在<a href="https://hdr.console.aliyun.com/">混合云容灾管理控制台</a>的容灾中心的<strong>受保护服务器</strong>页签，选择*<strong>*更多\</strong> &gt; *<em>反向注册***</em>。</p></li><li><p>添加物理服务器</p><ol><li><p>在<strong>站点对信息</strong>页签，单击<a href="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/1790579651/p46891.jpg"><img src="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/1790579651/p46891.jpg" alt="img"></a>添加计算平台。<br><a href="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/1790579651/p46904.jpg"><img src="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/1790579651/p46904.jpg" alt="img"></a></p></li><li><p>在<strong>添加计算平台</strong>对话框中，选择<strong>物理机</strong>，输入对应的机器名称，然后开始制作启动U盘。<br><a href="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/1790579651/p50816.jpg"><img src="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/1790579651/p50816.jpg" alt="img"></a></p></li><li><p>制作启动U盘</p><ol><li><p>准备工作</p><ul><li><p>需要一块至少8GB大小的U盘</p></li><li><p>免费的U盘制作工具</p><p>Rufus</p><p><strong>注意</strong></p><ul><li>使用Rufus会将U盘全部格式化掉。在开始制作前请先确保U盘上重要的数据已经做过备份。</li><li>除Rufus外，<a href="https://etcher.io/">Etcher</a><a href="http://unetbootin.github.io/">UNetbootin utility</a>。</li></ul></li><li><p>Aliyun-BCDR-BMR-Shadow-VM-Win-[version].iso镜像</p><p><strong>警告</strong> BMR恢复程序只能运行于有写权限的USB设备上，请勿将程序运行在CD或DVD等只读设备上，否则可能会产生不可预知的结果。</p></li></ul></li><li><p>USB驱动盘制作</p><p>按要求填写设备选项及格式化选项的各项参数，单击<strong>开始</strong>。</p><p><img src="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/1790579651/p50817.jpg" alt="img"></p><p>配置情况如下表所示：</p><table><thead><tr><th align="left">参数</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left"><strong>设备</strong></td><td align="left">选择插入的U盘</td></tr><tr><td align="left"><strong>引导类型选择</strong></td><td align="left">选择刚刚下载的Aliyun-BCDR-BMR-Shadow-VM-Win-2.5.0.iso镜像</td></tr><tr><td align="left"><strong>分区类型</strong></td><td align="left">选择<strong>MBR</strong></td></tr><tr><td align="left"><strong>目标系统类型</strong></td><td align="left">选择<strong>BIOS（或 UEFI-CMS）</strong></td></tr><tr><td align="left"><strong>卷标</strong></td><td align="left">输入<strong>CDR</strong></td></tr><tr><td align="left"><strong>文件系统</strong></td><td align="left">选择<strong>NTFS</strong></td></tr><tr><td align="left"><strong>簇大小</strong></td><td align="left">保持默认选项</td></tr><tr><td align="left"><strong>快速格式化</strong></td><td align="left">勾选此项</td></tr><tr><td align="left"><strong>创建扩展的标签和图标文件</strong></td><td align="left"></td></tr><tr><td align="left"><strong>检查设备坏块</strong></td><td align="left">勾选此项，并选择<strong>1遍</strong></td></tr></tbody></table><p>在弹出的<strong>Rufus</strong>窗口中单击<strong>确认</strong>即可完成启动U盘制作。<br><a href="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/2790579651/p50818.jpg"><img src="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/2790579651/p50818.jpg" alt="img"></a></p></li></ol></li><li><p>将U盘插入要被恢复的物理机，启动物理机进入U盘内部的WinPE系统，根据需要配置静态IP或者DHCP分配，然后在控制台填入IP地址，即可完成物理机的添加。<br><a href="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/2790579651/p50821.jpg"><img src="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/2790579651/p50821.jpg" alt="img"></a></p></li></ol></li><li><p>启动复制</p><p>单击*<strong>*更多\</strong> &gt; *<em>启动反向复制***</em>。在<strong>启动反向复制</strong>的对话框中，选择已添加的要恢复到的物理机。</p></li><li><p>本地恢复</p><p>在反向实时复制阶段，单击*<strong>*更多\</strong> &gt; *<em>故障恢复***</em>。此时拔掉物理机上的U盘，重新启动物理机，即可完成本地恢复（failback）。</p></li></ol><p><strong>后续操作</strong></p><p>故障恢复（failback）完成之后，默认情况下这台机器没有进入保护状态。您需要单击<strong>注册</strong>将这台机器注册到BCDR网关，然后启动复制，即可实现本地到云上的保护状态，形成了完整的闭环，避免了本地出现故障导致业务长时间中断造成的损失。<br><a href="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/2790579651/p50827.png"><img src="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/2790579651/p50827.png" alt="img"></a></p><p><strong>附录</strong></p><p>请按照如下步骤手动收缩分区：</p><ol><li>以Windows Server 2012为例，在任务栏左下角的Windows图标上单击右键，选择<strong>磁盘管理</strong>。<br><a href="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/2790579651/p50823.jpg"><img src="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/2790579651/p50823.jpg" alt="img"></a></li><li>在磁盘管理的界面上，选中系统分区，单击右键，选择<strong>压缩卷</strong>。<br><a href="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/2790579651/p50824.jpg"><img src="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/2790579651/p50824.jpg" alt="img"></a></li><li>在弹出的窗口中，输入想要压缩的空间量大小，然后单击<strong>压缩</strong>即可完成压缩分区。<br><a href="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/3790579651/p50825.jpg"><img src="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/3790579651/p50825.jpg" alt="img"></a></li></ol><p><strong>2、回切至本地VMware</strong></p><p>本文主要介绍如何利用阿里云连续复制型容灾（CDR）服务，在本地虚拟机出现问题后把云上恢复出来的ECS回切到云下VMware环境中。</p><p><strong>背景介绍</strong></p><p>目前阿里云的混合云容灾服务对本地的数据中心做保护，并实现在本地虚拟机出现故障的时候以秒级RPO，分钟级RTO在阿里云ECS上进行恢复。但是对于完整的容灾场景，还要求在本地虚拟机出现问题后，将云上恢复出来的ECS回切到云下VMware环境中。</p><p><strong>准备工作</strong></p><p>您需要<a href="https://help.aliyun.com/document_detail/92482.html">部署BCDR网关</a>，然后在被保护的Windows服务器上<a href="https://help.aliyun.com/document_detail/92483.html">安装阿里云复制服务</a>，并在<a href="https://hdr.console.aliyun.com/">混合云容灾管理控制台</a>的容灾中心的<strong>受保护服务器</strong>页签，选择*<strong>*更多\</strong> &gt; *<em>启动复制***</em>。<a href="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/0507305851/p46862.png"><img src="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/0507305851/p46862.png" alt="img"></a></p><p><strong>启动云上恢复</strong></p><p>请按如下步骤启动云上恢复：</p><ol><li><p>服务器进入实时复制状态后，您可以直接关闭被保护服务器的电源，在<a href="https://hdr.console.aliyun.com/">混合云容灾管理控制台</a>上查看到被保护服务器进入异常状态。<a href="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/0507305851/p46867.png"><img src="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/0507305851/p46867.png" alt="img"></a></p></li><li><p>单击*<strong>*更多\</strong> &gt; *<em>故障切换***</em>。<a href="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/1507305851/p46875.jpg"><img src="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/1507305851/p46875.jpg" alt="img"></a></p></li><li><p>在<strong>故障切换</strong>对话框，<strong>IP地址</strong>选择<strong>保留当前IP</strong>，<strong>恢复点</strong>保留<strong>当前时间</strong>的默认选项。<a href="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/1507305851/p63236.jpg"><img src="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/1507305851/p63236.jpg" alt="img"></a></p><p>等待几分钟后，可以看到恢复的ECS已被成功拉起。您可以通过单击下图链接来查看机器的状态。<a href="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/1507305851/p46881.png"><img src="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/1507305851/p46881.png" alt="img"></a></p></li><li><p>在弹出的<strong>完成故障切换</strong>对话框中，单击<strong>确定</strong>。<a href="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/1507305851/p46886.png"><img src="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/1507305851/p46886.png" alt="img"></a></p></li></ol><p><strong>本地恢复</strong></p><p>请按如下步骤进行本地恢复：</p><ol><li><p>确认云上恢复的ECS可以正常回切至本地环境后，在<a href="https://hdr.console.aliyun.com/">混合云容灾管理控制台</a>的容灾中心的<strong>受保护服务器</strong>页签，选择*<strong>*更多\</strong> &gt; *<em>反向注册***</em>。</p></li><li><p>在<strong>站点对信息</strong>页签，单击<a href="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/1507305851/p46891.jpg"><img src="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/1507305851/p46891.jpg" alt="img"></a>添加计算平台。<a href="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/1507305851/p46904.jpg"><img src="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/1507305851/p46904.jpg" alt="img"></a></p></li><li><p>在<strong>添加计算平台</strong>对话框中，填写要恢复到的vCenter<strong>名称</strong>、<strong>IP地址</strong>、<strong>用户名</strong>及<strong>密码</strong>。</p><p><strong>说明</strong> 请使用具有创建管理虚拟机权限的vCenter用户名、密码。</p></li><li><p>单击*<strong>*更多\</strong> &gt; *<em>启动反向复制***</em>。</p></li><li><p>在<strong>启动反向复制</strong>对话框中，填写相应的配置信息。<a href="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/2507305851/p46905.png"><img src="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/2507305851/p46905.png" alt="img"></a></p><p><strong>说明</strong> 复制存储（Datastore）和复制网络（Network）的选择依赖于计算资源，而计算资源（Compute Resource）的选择依赖于复制位置（Location）所在的Datacenter。</p></li><li><p>在反向实时复制阶段，单击*<strong>*更多\</strong> &gt; *<em>故障恢复***</em>。</p></li><li><p>故障恢复（failback）完成后，您可以到vCenter中查看云上恢复出来的ECS。<a href="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/2507305851/p46902.png"><img src="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/2507305851/p46902.png" alt="img"></a></p></li></ol><p><strong>后续操作</strong></p><p>故障恢复（failback）完成之后，默认情况下这台机器没有进入保护状态。您需要单击<strong>注册</strong>将这台机器注册到BCDR网关，然后启动复制，即可实现本地到云上的保护状态，形成了完整的闭环，避免了本地出现故障导致业务长时间中断造成的损失。<a href="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/2507305851/p46931.png"><img src="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/2507305851/p46931.png" alt="img"></a></p><h4 id="2-5-跨地域容灾"><a href="#2-5-跨地域容灾" class="headerlink" title="2.5 跨地域容灾"></a>2.5 跨地域容灾</h4><p>容灾系统部署在阿里云上两个地域中，当主系统发生故障时，业务系统切换到容灾系统。主系统和容灾系统部署在不同的地域，可靠性更高，有效避免了地域性灾害导致的系统故障。</p><h5 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h5><p>在实现跨地域容灾之前，您需要选择一个不同于生产环境的地域作为容灾目标地域。在该地域上创建云上专有网络（VPC），并创建复制网络交换机和恢复网络交换机，详情请参见<a href="https://help.aliyun.com/document_detail/92681.html#concept-92681-zh">搭建云上专有网络</a>。</p><h5 id="步骤一：创建容灾站点对"><a href="#步骤一：创建容灾站点对" class="headerlink" title="步骤一：创建容灾站点对"></a>步骤一：创建容灾站点对</h5><p>准备工作完成后，请按如下步骤对源站ECS进行跨地域容灾保护。</p><ol><li>登录<a href="https://hdr.console.aliyun.com/">混合云容灾管理控制台</a>。</li><li>单击*<strong>*概览\</strong> &gt; *<em>+创建容灾站点对*</em> &gt; *<em>连续复制型容灾***</em></li><li>在<strong>创建连续复制型容灾站点对</strong>页面，类型选择<strong>区域容灾到区域</strong>，并选择准备工作中为主从站创建好的VPC。<a href="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/9644993851/p54672.jpg"><img src="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/9644993851/p54672.jpg" alt="img"></a></li><li>单击<strong>创建</strong>。</li></ol><h5 id="步骤二：添加被保护服务器"><a href="#步骤二：添加被保护服务器" class="headerlink" title="步骤二：添加被保护服务器"></a>步骤二：添加被保护服务器</h5><p>连续复制型容灾站点对创建完成后，按以下步骤添加被保护服务器：</p><ol><li><p>单击已创建的容灾站点对，在容灾中心的<strong>受保护服务器</strong>页签，单击**+添加**。</p></li><li><p>在<strong>添加被保护服务器</strong>页面，选择已创建的ECS实例，单击<strong>确认</strong>。</p><p>服务器状态显示<strong>客户端安装中</strong>，随后显示<strong>已初始化</strong>。</p><p>如果服务器状态未显示已初始化，请单击*<strong>*更多\</strong> &gt; *<em>服务器操作*</em> &gt; *<em>重启服务器***</em>以完成初始化。</p></li></ol><h5 id="步骤三：启动复制"><a href="#步骤三：启动复制" class="headerlink" title="步骤三：启动复制"></a>步骤三：启动复制</h5><p>启动容灾复制，将服务器复制到云上，并维持实时复制。</p><ol><li><p>在连续复制型容灾的<strong>受保护服务器</strong>页签中，单击要启动容灾复制的服务器对应的<strong>操作</strong>按钮，选择*<strong>*更多\</strong> &gt; *<em>故障切换*</em> &gt; *<em>启动复制***</em>。</p></li><li><p>在<strong>启动复制</strong>对话框中，分别选择<strong>恢复点策略</strong>，是否<strong>使用SSD</strong>、根据<a href="https://help.aliyun.com/document_detail/92681.html#section-wzp-bnw-yfb">搭建云上专有网络</a>文档说明，选择用于<strong>复制网络</strong>和<strong>恢复网络</strong>的交换机。<a href="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/9644993851/p54552.jpg"><img src="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/9644993851/p54552.jpg" alt="img"></a></p></li><li><p>单击<strong>启动</strong>。</p><p>此时，容灾复制会先后进入<strong>启动复制</strong>、<strong>全量复制</strong>、<strong>实时复制中</strong>三个阶段。<a href="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/9644993851/p33816.png"><img src="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/9644993851/p33816.png" alt="img"></a></p><ul><li><strong>启动复制</strong>：混合云容灾服务正在扫描系统数据，评估总体数据量，这一阶段通常会持续几分钟。</li><li><strong>全量复制</strong>：混合云容灾服务正在把整台服务器的有效数据传输到阿里云，这一阶段所用时间取决于服务器数据量、网络带宽等因素。控制台进度条将会展示复制进度。</li><li><strong>实时复制中</strong>：全量复制完成后，阿里云上已经复制了您的全量数据，然后 AReS 将会在服务器上监视所有对磁盘的写操作，并持续地实时复制到阿里云。</li></ul></li></ol><h5 id="（可选）容灾演练"><a href="#（可选）容灾演练" class="headerlink" title="（可选）容灾演练"></a>（可选）容灾演练</h5><p>一旦进入实时复制状态，您就可以对服务器进行容灾演练操作了。</p><p>容灾演练将被容灾保护的服务器在云上拉起并验证应用正确性，是容灾流程整体中及其重要的一环，它的核心意义在于：</p><ul><li>方便地验证被容灾保护的应用可以在云上正常拉起。</li><li>确保操作人员熟悉容灾恢复流程，确保在主站真正发生故障时，操作人员可以顺畅地进行容灾切换。</li></ul><p>容灾演练操作步骤如下：</p><ol><li><p>在连续复制型容灾的<strong>受保护服务器</strong>页签中，单击要启动容灾复制的服务器对应的操作栏下的<strong>容灾演练</strong>。</p></li><li><p>在<strong>容灾演练</strong>对话框中，填写<strong>CPU</strong>、<strong>内存</strong>信息、选择<strong>恢复网络</strong>、<strong>IP地址</strong>、是否<strong>使用SSD</strong>、选择<strong>恢复点</strong>、<strong>弹性公网IP</strong>、<strong>切换后执行脚本</strong>。<a href="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/0744993851/p62344.jpg"><img src="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/0744993851/p62344.jpg" alt="img"></a></p><p><strong>说明</strong> 混合云容灾服务会自动为每个服务器保留最近 24 小时的 24 个恢复点。</p></li><li><p>单击<strong>启动</strong>。</p><p>此时，阿里云会在后台基于用户选定的时间点将服务器拉起。后台容灾演练过程中，实时数据复制不受影响。<a href="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/0744993851/p54596.jpg"><img src="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/0744993851/p54596.jpg" alt="img"></a></p></li><li><p>几分钟后，您会看到容灾演练完成，单击<strong>容灾演练信息</strong>下的链接，验证数据与应用。<a href="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/0744993851/p54597.jpg"><img src="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/0744993851/p54597.jpg" alt="img"></a></p></li><li><p>验证完成后，您需要单击该服务器对应的操作栏下的<strong>清空演练环境</strong>，此时恢复出来的ECS就会被删除。</p><p><strong>说明</strong> 容灾演练恢复出来的ECS验证完成后，建议尽快清空演练环境，以降低费用支出。</p></li></ol><h5 id="步骤四：故障切换"><a href="#步骤四：故障切换" class="headerlink" title="步骤四：故障切换"></a>步骤四：故障切换</h5><p>定期的容灾演练保证了您的业务可以随时在云上拉起。而当您的主站发生重大故障，需要在云上马上重启核心业务时，就需要进行故障切换操作了。</p><p><strong>警告</strong> 故障切换操作适用于被保护服务器已经出现严重故障的的情形，进行该操作会停掉实时复制流程。您需要重新启动复制，并完成一次全量复制才能对被保护服务器继续进行容灾保护。</p><p>故障切换步骤如下：</p><ol><li><p>在连续复制型容灾的<strong>受保护服务器</strong>页签中，单击要启动容灾复制的服务器对应的操作栏下的*<strong>*更多\</strong> &gt; *<em>故障切换*</em> &gt; *<em>故障切换***</em>。</p></li><li><p>在<strong>故障切换</strong>对话框中，填写<strong>CPU</strong>、<strong>内存</strong>信息、选择<strong>恢复网络</strong>、<strong>IP地址</strong>、是否<strong>使用SSD</strong>、选择<strong>恢复点</strong>、<strong>弹性公网IP</strong>、<strong>切换后执行脚本</strong>。</p><p><strong>注意</strong> <strong>当前时间</strong>恢复点只能使用一次。</p></li><li><p>单击<strong>启动</strong>。</p></li><li><p>故障切换完成后，您可以在单击<strong>故障切换/故障恢复信息</strong>下的链接，检查数据和应用。<a href="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/0744993851/p54601.jpg"><img src="https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/0744993851/p54601.jpg" alt="img"></a></p><ul><li><p>如果检查后发现当前时间点应用运行正常，可以直接单击</p><p><strong>更多</strong> &gt; <strong>故障切换</strong> &gt; <strong>确认故障切换</strong></p><p>操作。</p><p><strong>说明</strong> 在故障切换或者切换恢复点完成，并且已经确认被容灾保护的服务器恢复出的应用已经接管了业务的情况下，完成故障切换操作是为了清理容灾复制在云上占用的资源，节约资源使用。</p></li><li><p>如果检查后发现当前时间点应用状态不符合要求，例如数据库一致性问题，或者源端被污染的数据已经被同步到另一个地域，请在确认故障切换前，单击*<strong>*更多\</strong> &gt; *<em>故障切换*</em> &gt; *<em>切换恢复点***</em>操作。</p></li></ul><p><strong>说明</strong> 切换恢复点操作与故障切换操作类似，仅需选择更早的恢复点即可。</p></li></ol><h5 id="步骤五：反向复制"><a href="#步骤五：反向复制" class="headerlink" title="步骤五：反向复制"></a>步骤五：反向复制</h5><p>被保护服务器的应用完成从某个地域（如地域A）容灾复制到另一个地域（如地域B）后，还可以实施反向复制，即从地域B反向复制到地域A。</p><ol><li><p>在连续复制型容灾的<strong>受保护服务器</strong>页签中，单击操作栏下的*<strong>*更多\</strong> &gt; *<em>故障恢复*</em> &gt; *<em>反向注册***</em>后，确认反向注册被保护服务器。</p></li><li><p>单击操作栏下的*<strong>*更多\</strong> &gt; *<em>故障恢复*</em> &gt; *<em>启动反向注册***</em>。</p></li><li><p>在<strong>启动反向复制</strong>页面，选择是否勾选<strong>原机恢复</strong>，然后选择<strong>复制网络</strong>和<strong>恢复网络</strong>。</p><p><strong>警告</strong> 跨地域及跨可用区容灾支持原机恢复。当使用原机恢复时，所使用的ECS主机中的数据会被清除，请谨慎选择。</p></li><li><p>单击<strong>启动</strong>。</p></li><li><p>待服务器进入反向实时复制状态时，单击操作栏下的*<strong>*更多\</strong> &gt; *<em>故障恢复*</em> &gt; *<em>故障恢复***</em>。</p></li><li><p>在<strong>故障恢复</strong>页面，填写<strong>CPU</strong>、<strong>内存</strong>信息、选择<strong>恢复网络</strong>、<strong>IP地址</strong>、编辑<strong>恢复后执行脚本</strong>。</p></li><li><p>故障恢复完成后，单击操作栏下的*<strong>*更多\</strong> &gt; *<em>故障切换*</em> &gt; *<em>注册***</em>，再次注册被保护服务器。</p></li></ol><h2 id="更多参考"><a href="#更多参考" class="headerlink" title="更多参考"></a>更多参考</h2><ul><li><a href="https://help.aliyun.com/document_detail/92125.html#concept-92125-zh">IDC容灾到云</a></li><li><a href="https://help.aliyun.com/document_detail/129193.html#concept-1597066">阿里云上跨可用区容灾</a></li></ul><h4 id="2-6-跨可用区容灾"><a href="#2-6-跨可用区容灾" class="headerlink" title="2.6 跨可用区容灾"></a>2.6 跨可用区容灾</h4><p>当生产站点因为不可抗力因素（比如火灾、地震）或者设备故障（软、硬件破坏）导致应用在短时间内无法恢复时，混合云容灾服务支持业务的跨可用区（Zone）的容灾能力，对整体的应用做容灾备份来应对单地区的故障，满足业务的RTO/RPO核心指标。</p><h5 id="准备工作-1"><a href="#准备工作-1" class="headerlink" title="准备工作"></a>准备工作</h5><p>在实现跨可用区容灾之前，您需要选择一个其他可用区创建云上专有网络（VPC），并在目的端创建复制网络交换机和恢复网络交换机，详情请参见<a href="https://help.aliyun.com/document_detail/92681.html#concept-92681-zh">搭建云上专有网络</a>。</p><h5 id="步骤一：创建容灾站点对-1"><a href="#步骤一：创建容灾站点对-1" class="headerlink" title="步骤一：创建容灾站点对"></a>步骤一：创建容灾站点对</h5><p>准备工作完成后，请按如下步骤对源站ECS进行跨可用区容灾保护。</p><ol><li>登录<a href="https://hdr.console.aliyun.com/">混合云容灾管理控制台</a>。</li><li>单击*<strong>*创建容灾站点对\</strong> &gt; *<em>连续复制型容灾***</em>。</li><li>在<strong>创建连续复制型容灾站点对</strong>页面，类型选择<strong>可用区容灾到可用区</strong>，并选择准备工作中为主从站创建好的VPC。<a href="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/2544725751/p62461.jpg"><img src="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/2544725751/p62461.jpg" alt="img"></a></li><li>单击<strong>创建</strong>。</li></ol><h5 id="步骤二：添加被保护服务器-1"><a href="#步骤二：添加被保护服务器-1" class="headerlink" title="步骤二：添加被保护服务器"></a>步骤二：添加被保护服务器</h5><p>连续复制型容灾站点对创建完成后，按以下步骤添加被保护服务器：</p><ol><li><p>单击已创建的容灾站点对，在容灾中心的<strong>受保护服务器</strong>页签，单击**+添加**。</p></li><li><p>在<strong>添加被保护服务器</strong>页面，选择已创建的ECS实例，单击<strong>确认</strong>。</p><p>服务器状态显示<strong>客户端安装中</strong>，随后显示<strong>已初始化</strong>。</p><p>如果服务器状态未显示已初始化，请单击*<strong>*更多\</strong> &gt; *<em>服务器操作*</em> &gt; *<em>重启服务器***</em>以完成初始化。</p></li></ol><h5 id="步骤三：启动复制-1"><a href="#步骤三：启动复制-1" class="headerlink" title="步骤三：启动复制"></a>步骤三：启动复制</h5><p>启动容灾复制，将服务器复制到云上，并维持实时复制。</p><ol><li><p>在连续复制型容灾的<strong>受保护服务器</strong>页签中，单击要启动容灾复制的服务器对应的<strong>操作</strong>按钮，选择*<strong>*更多\</strong> &gt; *<em>故障切换*</em> &gt; *<em>启动复制***</em>。</p></li><li><p>在<strong>启动复制</strong>对话框中，分别选择<strong>恢复点策略</strong>，是否<strong>使用SSD</strong>、根据<a href="https://help.aliyun.com/document_detail/92681.html#section-wzp-bnw-yfb">搭建云上专有网络</a>文档说明，选择用于<strong>复制网络</strong>和<strong>恢复网络</strong>的交换机。<a href="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/2544725751/p54552.jpg"><img src="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/2544725751/p54552.jpg" alt="img"></a></p></li><li><p>单击<strong>启动</strong>。</p><p>此时，容灾复制会先后进入<strong>启动复制</strong>、<strong>全量复制</strong>、<strong>实时复制中</strong>三个阶段。<a href="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/2544725751/p33816.png"><img src="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/2544725751/p33816.png" alt="img"></a></p><ul><li><strong>启动复制</strong>：混合云容灾服务正在扫描系统数据，评估总体数据量，这一阶段通常会持续几分钟。</li><li><strong>全量复制</strong>：混合云容灾服务正在把整台服务器的有效数据传输到阿里云，这一阶段所用时间取决于服务器数据量、网络带宽等因素。控制台进度条将会展示复制进度。</li><li><strong>实时复制中</strong>：全量复制完成后，阿里云上已经复制了您的全量数据，然后 AReS 将会在服务器上监视所有对磁盘的写操作，并持续地实时复制到阿里云。</li></ul></li></ol><h5 id="（可选）容灾演练-1"><a href="#（可选）容灾演练-1" class="headerlink" title="（可选）容灾演练"></a>（可选）容灾演练</h5><p>一旦进入实时复制状态，您就可以对服务器进行容灾演练操作了。</p><p>容灾演练将被容灾保护的服务器在云上拉起并验证应用正确性，是容灾流程整体中及其重要的一环，它的核心意义在于：</p><ul><li>方便地验证被容灾保护的应用可以在云上正常拉起。</li><li>确保操作人员熟悉容灾恢复流程，确保在主站真正发生故障时，操作人员可以顺畅地进行容灾切换。</li></ul><p>容灾演练操作步骤如下：</p><ol><li><p>在连续复制型容灾的<strong>受保护服务器</strong>页签中，单击要启动容灾复制的服务器对应的操作栏下的<strong>容灾演练</strong>。</p></li><li><p>在<strong>容灾演练</strong>对话框中，填写<strong>CPU</strong>、<strong>内存</strong>信息、选择<strong>恢复网络</strong>、<strong>IP地址</strong>、是否<strong>使用SSD</strong>、选择<strong>恢复点</strong>、<strong>弹性公网IP</strong>、<strong>切换后执行脚本</strong>。<a href="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/2544725751/p62344.jpg"><img src="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/2544725751/p62344.jpg" alt="img"></a></p><p><strong>说明</strong> 混合云容灾服务会自动为每个服务器保留最近 24 小时的 24 个恢复点。</p></li><li><p>单击<strong>启动</strong>。</p><p>此时，阿里云会在后台基于用户选定的时间点将服务器拉起。后台容灾演练过程中，实时数据复制不受影响。<a href="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/2544725751/p54596.jpg"><img src="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/2544725751/p54596.jpg" alt="img"></a></p></li><li><p>几分钟后，您会看到容灾演练完成，单击<strong>容灾演练信息</strong>下的链接，验证数据与应用。<a href="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/3544725751/p54597.jpg"><img src="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/3544725751/p54597.jpg" alt="img"></a></p></li><li><p>验证完成后，您需要单击该服务器对应的操作栏下的<strong>清空演练环境</strong>，此时恢复出来的ECS就会被删除。</p><p><strong>说明</strong> 容灾演练恢复出来的ECS验证完成后，建议尽快清空演练环境，以降低费用支出。</p></li></ol><h5 id="步骤四：故障切换-1"><a href="#步骤四：故障切换-1" class="headerlink" title="步骤四：故障切换"></a>步骤四：故障切换</h5><p>定期的容灾演练保证了您的业务可以随时在云上拉起。而当您的主站发生重大故障，需要在云上马上重启核心业务时，就需要进行故障切换操作了。</p><p><strong>警告</strong> 故障切换操作适用于被保护服务器已经出现严重故障的的情形，进行该操作会停掉实时复制流程。您需要重新启动复制，并完成一次全量复制才能对被保护服务器继续进行容灾保护。</p><p>故障切换步骤如下：</p><ol><li><p>在连续复制型容灾的<strong>受保护服务器</strong>页签中，单击要启动容灾复制的服务器对应的操作栏下的*<strong>*更多\</strong> &gt; *<em>故障切换*</em> &gt; *<em>故障切换***</em>。</p></li><li><p>在<strong>故障切换</strong>对话框中，填写<strong>CPU</strong>、<strong>内存</strong>信息、选择<strong>恢复网络</strong>、<strong>IP地址</strong>、是否<strong>使用SSD</strong>、选择<strong>恢复点</strong>、<strong>弹性公网IP</strong>、<strong>切换后执行脚本</strong>。</p><p><strong>注意</strong> <strong>当前时间</strong>恢复点只能使用一次。</p></li><li><p>单击<strong>启动</strong>。</p></li><li><p>故障切换完成后，您可以在单击<strong>故障切换/故障恢复信息</strong>下的链接，检查数据和应用。<a href="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/3544725751/p54601.jpg"><img src="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/3544725751/p54601.jpg" alt="img"></a></p><ul><li><p>如果检查后发现当前时间点应用运行正常，可以直接单击</p><p><strong>更多</strong> &gt; <strong>故障切换</strong> &gt; <strong>确认故障切换</strong></p><p>操作。</p><p><strong>说明</strong> 在故障切换或者切换恢复点完成，并且已经确认被容灾保护的服务器恢复出的应用已经接管了业务的情况下，完成故障切换操作是为了清理容灾复制在云上占用的资源，节约资源使用。</p></li><li><p>如果检查后发现当前时间点应用状态不符合要求，例如数据库一致性问题，或者源端被污染的数据已经被同步到另一个可用区，请在确认故障切换前，单击*<strong>*更多\</strong> &gt; *<em>故障切换*</em> &gt; *<em>切换恢复点***</em>操作。</p></li></ul><p><strong>说明</strong> 切换恢复点操作与故障切换操作类似，仅需选择更早的恢复点即可。</p></li></ol><h5 id="步骤五：反向复制-1"><a href="#步骤五：反向复制-1" class="headerlink" title="步骤五：反向复制"></a>步骤五：反向复制</h5><p>被保护服务器的应用完成某个可用区（如可用区A）容灾复制到另一个可用区（如可用区B）后，还可以实施反向复制，即从可用区B反向复制到可用区A。</p><ol><li><p>在连续复制型容灾的受保护服务器页签中，单击操作栏下的*更多* &gt; *故障恢复* &gt; *反向注册*后，确认反向注册被保护服务器。</p></li><li><p>单击操作栏下的*更多* &gt; *故障恢复* &gt; *启动反向注册*。</p></li><li><p>在启动反向复制页面，选择是否勾选原机恢复，然后选择复制网络和恢复网络。</p><p>警告 跨地域及跨可用区容灾支持原机恢复。当使用原机恢复时，所使用的ECS主机中的数据会被清除，请谨慎选择。</p></li><li><p>单击启动。</p></li><li><p>待服务器进入反向实时复制状态时，单击操作栏下的*更多* &gt; *故障恢复* &gt; *故障恢复*。</p></li><li><p>在故障恢复页面，填写CPU、内存信息、选择恢复网络、IP地址、编辑恢复后执行脚本。</p></li><li><p>故障恢复完成后，单击操作栏下的*更多* &gt; *故障切换* &gt; *注册*，再次注册被保护服务器。</p></li></ol><hr><h3 id="三、Hadoop-集群灾备概述"><a href="#三、Hadoop-集群灾备概述" class="headerlink" title="三、Hadoop 集群灾备概述"></a>三、Hadoop 集群灾备概述</h3><p>混合云大数据容灾（英文 HDR for Big Data， 简称 HDR-BD）是针对 Hadoop 集群的灾备方案。</p><p><strong>说明</strong> 目前 HDR-BD 正在邀测，您可以到混合云容灾服务控制台中注册，我们会评估后尽早联系您。您也可以联系阿里云 CBM 获取邀测资格。HDR-BD 在邀测阶段不收取服务费用，但您可能需要承担测试产生的 EMR、存储、网络等资源费用。</p><p>基于领先的数据双向实时复制技术，HDR-BD 可以实现 Hadoop 集群双活和准 0 RPO 容灾。同时，通过与阿里云对象存储 OSS 的紧密集成，您也可以将集群数据实时备份至阿里云 OSS，实现非常简单高效的数据备份。<br><a href="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/64180/155073893238258_zh-CN.png"><img src="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/64180/155073893238258_zh-CN.png" alt="img"></a></p><h4 id="技术原理"><a href="#技术原理" class="headerlink" title="技术原理"></a>技术原理</h4><p>HDR-BD 的核心原理是 Hadoop 集群间的数据实时双向复制。对于 HDFS 上的文件写操作，通过元数据同步复制和数据异步复制，实现了极低的 RPO，系统轻松实现数据保护和集群双活。一个文件写操作的具体流程如下图所示：<br><a href="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/64180/155073893238259_zh-CN.png"><img src="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/64180/155073893238259_zh-CN.png" alt="img"></a></p><h4 id="主要优势"><a href="#主要优势" class="headerlink" title="主要优势"></a>主要优势</h4><p>HDR-BD 为大数据灾备设立了一个全新的标准，其主要优势包括运维复杂度低、近 0 RPO、高资源利用率等。</p><ul><li><p>运维复杂度低</p><p>HDR-BD 实现了数据的全自动实时双向复制，无需特定时间窗口，也无需担心对业务的影响</p></li><li><p>近 0 RPO</p><p>数据的实时复制决定了每一个写操作都会实时复制到配对集群，RPO 几乎为0。</p></li><li><p>高资源利用率</p><p>数据双向复制确保运行在不同应用的两个集群共享一份数据，不要求一个集群必须处于只读或备用状态，计算资源得以充分利用。</p></li></ul><h4 id="核心场景"><a href="#核心场景" class="headerlink" title="核心场景"></a>核心场景</h4><p>HDR-BD 的核心场景包括跨集群大数据湖、Hadoop 集群双活容灾、Hadoop 数据实时云备份。</p><ul><li><p>跨集群大数据湖</p><p>在多个 Hadoop 集群之间建立实时双向复制，使数据在多个集群之间无缝流动，而且可以根据不同集群的角色，制订数据复制规则。每个集群在运行不同任务的同时，又能够聚合、分发、共享数据，形成大数据湖，充分发挥数据的效能。</p></li><li><p>Hadoop 集群双活容灾</p><p>通过在自建 Hadoop 集群和云上 EMR 集群间，或者在云上 EMR 集群间安装配置 HDR-BD 服务，可以确保两个集群间数据实时双向复制，实现近 0 RPO的大数据集群容灾。两个集群可以各自运行不同的业务，避免资源浪费。所有数据变化都会在两个集群间同步，当一个集群发生重大故障时，您可以在另一个集群启动业务，期间几乎没有数据丢失。</p></li><li><p>Hadoop 数据实时云备份</p><p>自建 Hadoop 集群可以通过 HDR-BD 服务与阿里云对象存储 OSS 建立实时单向复制。集群上的数据将会以极短的 RPO 复制到 OSS 上。无需配置备份策略、分配备份时间窗口，Hadoop 集群数据即可轻松得到保护。</p></li></ul><hr><h3 id="四、混合云容灾服务常见问题"><a href="#四、混合云容灾服务常见问题" class="headerlink" title="四、混合云容灾服务常见问题"></a>四、混合云容灾服务常见问题</h3><h4 id="4-1-一般问题"><a href="#4-1-一般问题" class="headerlink" title="4.1 一般问题"></a>4.1 一般问题</h4><p>1、混合云容灾服务必须要购买高速接入服务吗？</p><p>混合云容灾服务可以安全地通过公网将数据实时复制到阿里云，在每日增数据增量不大的情况下，并不需要额外购买专线。但是如果数据量较大、对上云的速度有明确的要求时，建议用高速接入。</p><p>同时您需要考虑云上容灾恢复之后，内网的客户端如何与恢复出来的应用的连接问题。在没有专线的情况下，SSLVPN可以为您在云上恢复应用后提供一个安全的链接。</p><h4 id="4-2-连续复制型容灾（CDR）常见问题"><a href="#4-2-连续复制型容灾（CDR）常见问题" class="headerlink" title="4.2 连续复制型容灾（CDR）常见问题"></a>4.2 连续复制型容灾（CDR）常见问题</h4><p>1、连续复制型容灾（CDR）能达到什么样的RPO和RTO？</p><p>企业自建数据中心的业务持续性保障 ：将企业自建数据中心内运行的核心业务数据实时复制上云，达到秒—分级的 RPO。在自建数据中心发生重大故障时，几分钟内在云上拉起，达到分钟级 RTO。</p><p>2、连续复制型容灾（CDR）支持哪些物理机及虚拟机？</p><p>CDR支持x86物理机，VMWare、Hyper-V以及KVM上运行的Windows和Linux虚拟服务器。</p><p>3、连续复制型容灾（CDR）支持哪些操作系统？</p><p>CDR支持主流的Windows和Linux操作系统。</p><h4 id="4-3-快照型容灾（SDR）常见问题"><a href="#4-3-快照型容灾（SDR）常见问题" class="headerlink" title="4.3 快照型容灾（SDR）常见问题"></a>4.3 快照型容灾（SDR）常见问题</h4><p>1、快照型容灾（SDR）能达到什么样的 RPO 和 RTO？</p><p>SDR是阿里云混合云容灾服务推出的基于对应用和服务器整机的全自动定时备份和备份恢复，从而实现数据级和应用级的小时—天级 RPO/RTO 云容灾。</p><p>SDR支持最低15分钟的RPO。RTO取决于您要恢复的数据量，云上单台容灾恢复网关可以提供250 MB/s的恢复速度，部署多台容灾恢复网关可以线性提高恢复速度。</p><p>2、快照型容灾（SDR）支持哪些操作系统？</p><p>SDR支持主流的Windows和Linux操作系统。</p><p>3、快照型容灾（SDR）支持运行在Hyper-v和VMWare上的虚拟机吗？</p><p>SDR支持Hyper-v和vSphere上运行的虚拟机。</p>]]></content>
    
    
    <summary type="html">云计算-阿里云-云存储-HDR</summary>
    
    
    
    <category term="云计算" scheme="https://sundal.top/categories/%E4%BA%91%E8%AE%A1%E7%AE%97/"/>
    
    <category term="阿里云" scheme="https://sundal.top/categories/%E4%BA%91%E8%AE%A1%E7%AE%97/%E9%98%BF%E9%87%8C%E4%BA%91/"/>
    
    <category term="云存储" scheme="https://sundal.top/categories/%E4%BA%91%E8%AE%A1%E7%AE%97/%E9%98%BF%E9%87%8C%E4%BA%91/%E4%BA%91%E5%AD%98%E5%82%A8/"/>
    
    <category term="HDR" scheme="https://sundal.top/categories/%E4%BA%91%E8%AE%A1%E7%AE%97/%E9%98%BF%E9%87%8C%E4%BA%91/%E4%BA%91%E5%AD%98%E5%82%A8/HDR/"/>
    
    
    <category term="阿里云" scheme="https://sundal.top/tags/%E9%98%BF%E9%87%8C%E4%BA%91/"/>
    
    <category term="云存储" scheme="https://sundal.top/tags/%E4%BA%91%E5%AD%98%E5%82%A8/"/>
    
  </entry>
  
  <entry>
    <title>阿里云DataWorks学习视频汇总</title>
    <link href="https://sundal.top/2020/11/13/09%20%E4%BA%91%E8%AE%A1%E7%AE%97/9.4%20%E9%98%BF%E9%87%8C%E4%BA%91/%E9%98%BF%E9%87%8C%E4%BA%91DataWorks%E5%AD%A6%E4%B9%A0%E8%A7%86%E9%A2%91%E6%B1%87%E6%80%BB/"/>
    <id>https://sundal.top/2020/11/13/09%20%E4%BA%91%E8%AE%A1%E7%AE%97/9.4%20%E9%98%BF%E9%87%8C%E4%BA%91/%E9%98%BF%E9%87%8C%E4%BA%91DataWorks%E5%AD%A6%E4%B9%A0%E8%A7%86%E9%A2%91%E6%B1%87%E6%80%BB/</id>
    <published>2020-11-13T07:00:20.273Z</published>
    <updated>2020-11-14T04:35:32.566Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>注意：本文档中引用的视频均来自阿里云官方的帮助文档，本文档仅仅是汇总整理，方便学习。</p><p><a href="https://help.aliyun.com/product/72772.html">阿里云DataWorks帮助文档链接</a></p></blockquote><a id="more"></a><hr><h4 id="一、DataWorks-V2-前生后世"><a href="#一、DataWorks-V2-前生后世" class="headerlink" title="一、DataWorks V2 前生后世"></a>一、DataWorks V2 前生后世</h4><p><video width="720" height="450"  preload="none" controls src="http://cloud.video.taobao.com/play/u/3926817755/p/1/e/6/t/1/214241735204.mp4">DataWorks V2 前生后世</video></p><hr><h4 id="二、DataWorks功能介绍"><a href="#二、DataWorks功能介绍" class="headerlink" title="二、DataWorks功能介绍"></a>二、DataWorks功能介绍</h4><h5 id="1、MaxCompute管家详解"><a href="#1、MaxCompute管家详解" class="headerlink" title="1、MaxCompute管家详解"></a>1、MaxCompute管家详解</h5><p><video width="720" height="450"  preload="none" controls src="https://cloud.video.taobao.com/play/u/870834/p/1/e/6/t/1/258126684330.mp4">MaxCompute管家详解</video></p><hr><h5 id="2、DataWorks数据集成介绍及实践"><a href="#2、DataWorks数据集成介绍及实践" class="headerlink" title="2、DataWorks数据集成介绍及实践"></a>2、DataWorks数据集成介绍及实践</h5><p><video width="720" height="450"  preload="none" controls src="http://cloud.video.taobao.com/play/u/870834/p/1/e/6/t/1/286389460364.mp4">DataWorks数据集成介绍及实践</video></p><hr><h5 id="3、DataWorks数据开发介绍及实践"><a href="#3、DataWorks数据开发介绍及实践" class="headerlink" title="3、DataWorks数据开发介绍及实践"></a>3、DataWorks数据开发介绍及实践</h5><p><video width="720" height="450"  preload="none" controls src="http://cloud.video.taobao.com/play/u/870834/p/1/e/6/t/1/286386220538.mp4">DataWorks数据开发介绍及实践</video></p><hr><h5 id="4、DataWorks数据分析介绍及实践"><a href="#4、DataWorks数据分析介绍及实践" class="headerlink" title="4、DataWorks数据分析介绍及实践"></a>4、DataWorks数据分析介绍及实践</h5><p><video width="720" height="450"  preload="none" controls src="http://cloud.video.taobao.com/play/u/870834/p/1/e/6/t/1/285673078050.mp4">DataWorks数据分析介绍及实践</video></p><hr><h5 id="5、DataWorks数据服务介绍及实践"><a href="#5、DataWorks数据服务介绍及实践" class="headerlink" title="5、DataWorks数据服务介绍及实践"></a>5、DataWorks数据服务介绍及实践</h5><p><video width="720" height="450"  preload="none" controls src="http://cloud.video.taobao.com/play/u/870834/p/1/e/6/t/1/285124872561.mp4">DataWorks数据服务介绍及实践</video></p><hr><h5 id="6、-DataWorks数据安全介绍及实践"><a href="#6、-DataWorks数据安全介绍及实践" class="headerlink" title="6、 DataWorks数据安全介绍及实践"></a>6、 DataWorks数据安全介绍及实践</h5><p><video width="720" height="450"  preload="none" controls src="http://cloud.video.taobao.com/play/u/870834/p/1/e/6/t/1/285675758510.mp4"> DataWorks数据安全介绍及实践</video></p><hr><h5 id="7、-DataWorks迁移助手介绍及实践"><a href="#7、-DataWorks迁移助手介绍及实践" class="headerlink" title="7、 DataWorks迁移助手介绍及实践"></a>7、 DataWorks迁移助手介绍及实践</h5><p><video width="720" height="450"  preload="none" controls src="http://cloud.video.taobao.com/play/u/870834/p/1/e/6/t/1/285125960087.mp4"> DataWorks迁移助手介绍及实践</video></p><hr><h4 id="三、DataWorks操作指导"><a href="#三、DataWorks操作指导" class="headerlink" title="三、DataWorks操作指导"></a>三、DataWorks操作指导</h4><h5 id="1、DataWorks增值版本详解"><a href="#1、DataWorks增值版本详解" class="headerlink" title="1、DataWorks增值版本详解"></a>1、DataWorks增值版本详解</h5><p><video width="720" height="450"  preload="none" controls src="https://cloud.video.taobao.com/play/u/3926817755/p/1/e/6/t/1/234005420131.mp4">DataWorks增值版本详解</video></p><hr><h5 id="2、DataWorks商业化资源组"><a href="#2、DataWorks商业化资源组" class="headerlink" title="2、DataWorks商业化资源组"></a>2、DataWorks商业化资源组</h5><p><video width="720" height="450"  preload="none" controls src="https://cloud.video.taobao.com/play/u/870834/p/1/e/6/t/1/256651914269.mp4">DataWorks商业化资源组</video></p><hr><h5 id="3、DataWorks智能监控简介与最佳实践"><a href="#3、DataWorks智能监控简介与最佳实践" class="headerlink" title="3、DataWorks智能监控简介与最佳实践"></a>3、DataWorks智能监控简介与最佳实践</h5><p><video width="720" height="450"  preload="none" controls src="http://cloud.video.taobao.com/play/u/3926817755/p/1/e/6/t/1/215917529599.mp4">DataWorks智能监控简介与最佳实践</video></p><hr><h5 id="4、DataWorks数据质量简介及最佳实践"><a href="#4、DataWorks数据质量简介及最佳实践" class="headerlink" title="4、DataWorks数据质量简介及最佳实践"></a>4、DataWorks数据质量简介及最佳实践</h5><p><video width="720" height="450"  preload="none" controls src="http://cloud.video.taobao.com/play/u/3926817755/p/1/e/6/t/1/215866716859.mp4">DataWorks数据质量简介及最佳实践</video></p><hr><h5 id="5、DataWorks数据安全简介与最佳实践"><a href="#5、DataWorks数据安全简介与最佳实践" class="headerlink" title="5、DataWorks数据安全简介与最佳实践"></a>5、DataWorks数据安全简介与最佳实践</h5><p><video width="720" height="450"  preload="none" controls src="https://cloud.video.taobao.com/play/u/3926817755/p/1/e/6/t/1/215963182038.mp4">DataWorks数据安全简介与最佳实践</video></p><hr><h5 id="6、Function-Studio简介与使用指导"><a href="#6、Function-Studio简介与使用指导" class="headerlink" title="6、Function Studio简介与使用指导"></a>6、Function Studio简介与使用指导</h5><p><video width="720" height="450"  preload="none" controls src="http://cloud.video.taobao.com/play/u/3926817755/p/1/e/6/t/1/215957166944.mp4">Function Studio简介与使用指导</video></p><hr><h5 id="7、DataWorks-on-EMR操作演示"><a href="#7、DataWorks-on-EMR操作演示" class="headerlink" title="7、DataWorks on EMR操作演示"></a>7、DataWorks on EMR操作演示</h5><p><video width="720" height="450"  preload="none" controls src="https://cloud.video.taobao.com/play/u/3926817755/p/1/e/6/t/1/249572978192.mp4">DataWorks on EMR操作演示</video></p><hr><h5 id="8、DataWorks-WorkShop操作"><a href="#8、DataWorks-WorkShop操作" class="headerlink" title="8、DataWorks WorkShop操作"></a>8、DataWorks WorkShop操作</h5><p><video width="720" height="450"  preload="none" controls src="https://cloud.video.taobao.com/play/u/870834/p/1/e/6/t/1/256682094521.mp4">DataWorks WorkShop操作</video></p><hr><h5 id="9、DataWorks调度任务迁移"><a href="#9、DataWorks调度任务迁移" class="headerlink" title="9、DataWorks调度任务迁移"></a>9、DataWorks调度任务迁移</h5><p><video width="720" height="450"  preload="none" controls src="https://cloud.video.taobao.com/play/u/870834/p/1/e/6/t/1/256486417823.mp4">DataWorks调度任务迁移</video></p><hr><h4 id="四、DataWorks问题排查"><a href="#四、DataWorks问题排查" class="headerlink" title="四、DataWorks问题排查"></a>四、DataWorks问题排查</h4><p><video width="720" height="450"  preload="none" controls src="https://cloud.video.taobao.com/play/u/3926817755/p/1/e/6/t/1/214136120302.mp4">DataWorks问题排查</video></p><hr><h4 id="五、DataWorks最佳实践"><a href="#五、DataWorks最佳实践" class="headerlink" title="五、DataWorks最佳实践"></a>五、DataWorks最佳实践</h4><h5 id="1、DataWorks版本概述与最佳实践"><a href="#1、DataWorks版本概述与最佳实践" class="headerlink" title="1、DataWorks版本概述与最佳实践"></a>1、DataWorks版本概述与最佳实践</h5><p><video width="720" height="450"  preload="none" controls src="https://cloud.video.taobao.com/play/u/3926817755/p/1/e/6/t/1/50237302884.mp4">DataWorks版本概述与最佳实践</video></p><hr><h5 id="2、DataWorks数据质量介绍及最佳实践"><a href="#2、DataWorks数据质量介绍及最佳实践" class="headerlink" title="2、DataWorks数据质量介绍及最佳实践"></a>2、DataWorks数据质量介绍及最佳实践</h5><p><video width="720" height="450"  preload="none" controls src="https://cloud.video.taobao.com/play/u/870834/p/1/e/6/t/1/256676806735.mp4">DataWorks数据质量介绍及最佳实践</video></p><hr><h5 id="3、基于DataWorks数据服务快速搭建疫情大屏"><a href="#3、基于DataWorks数据服务快速搭建疫情大屏" class="headerlink" title="3、基于DataWorks数据服务快速搭建疫情大屏"></a>3、基于DataWorks数据服务快速搭建疫情大屏</h5><p><video width="720" height="450"  preload="none" controls src="https://cloud.video.taobao.com/play/u/870834/p/1/e/6/t/1/256470993051.mp4">基于DataWorks数据服务快速搭建疫情大屏</video></p><hr><h5 id="4、DataWorks数据集成与开源Sqoop的对比"><a href="#4、DataWorks数据集成与开源Sqoop的对比" class="headerlink" title="4、DataWorks数据集成与开源Sqoop的对比"></a>4、DataWorks数据集成与开源Sqoop的对比</h5><p><video width="720" height="450"  preload="none" controls src="https://cloud.video.taobao.com/play/u/870834/p/1/e/6/t/1/256671598152.mp4">DataWorks数据集成与开源Sqoop的对比</video></p><hr><blockquote><p>整  理  人：山外Sundal</p><p>参考文档：<a href="https://help.aliyun.com/product/72772.html">阿里云DataWorks帮助文档</a></p><p>日        期：2020.11.11</p></blockquote>]]></content>
    
    
    <summary type="html">云计算-阿里云-大数据-DataWorks</summary>
    
    
    
    <category term="云计算" scheme="https://sundal.top/categories/%E4%BA%91%E8%AE%A1%E7%AE%97/"/>
    
    <category term="阿里云" scheme="https://sundal.top/categories/%E4%BA%91%E8%AE%A1%E7%AE%97/%E9%98%BF%E9%87%8C%E4%BA%91/"/>
    
    <category term="大数据" scheme="https://sundal.top/categories/%E4%BA%91%E8%AE%A1%E7%AE%97/%E9%98%BF%E9%87%8C%E4%BA%91/%E5%A4%A7%E6%95%B0%E6%8D%AE/"/>
    
    <category term="DataWorks" scheme="https://sundal.top/categories/%E4%BA%91%E8%AE%A1%E7%AE%97/%E9%98%BF%E9%87%8C%E4%BA%91/%E5%A4%A7%E6%95%B0%E6%8D%AE/DataWorks/"/>
    
    
    <category term="云计算" scheme="https://sundal.top/tags/%E4%BA%91%E8%AE%A1%E7%AE%97/"/>
    
    <category term="阿里云" scheme="https://sundal.top/tags/%E9%98%BF%E9%87%8C%E4%BA%91/"/>
    
    <category term="大数据" scheme="https://sundal.top/tags/%E5%A4%A7%E6%95%B0%E6%8D%AE/"/>
    
    <category term="DataWorks" scheme="https://sundal.top/tags/DataWorks/"/>
    
  </entry>
  
  <entry>
    <title>Hello World</title>
    <link href="https://sundal.top/2020/11/13/13%20%E5%85%B6%E4%BB%96/hello-world/"/>
    <id>https://sundal.top/2020/11/13/13%20%E5%85%B6%E4%BB%96/hello-world/</id>
    <published>2020-11-13T06:58:27.783Z</published>
    <updated>2020-11-14T05:04:27.120Z</updated>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><a id="more"></a><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% pdf &#x2F;source&#x2F;pdf&#x2F;page.title.pdf %&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;Welcome to &lt;a href=&quot;https://hexo.io/&quot;&gt;Hexo&lt;/a&gt;! This is your very first post. Check &lt;a href=&quot;https://hexo.io/docs/&quot;&gt;documentation&lt;/a&gt; for more info. If you get any problems when using Hexo, you can find the answer in &lt;a href=&quot;https://hexo.io/docs/troubleshooting.html&quot;&gt;troubleshooting&lt;/a&gt; or you can ask me on &lt;a href=&quot;https://github.com/hexojs/hexo/issues&quot;&gt;GitHub&lt;/a&gt;.&lt;/p&gt;</summary>
    
    
    
    <category term="主题" scheme="https://sundal.top/categories/%E4%B8%BB%E9%A2%98/"/>
    
    
    <category term="hexo" scheme="https://sundal.top/tags/hexo/"/>
    
    <category term="pdf" scheme="https://sundal.top/tags/pdf/"/>
    
  </entry>
  
</feed>
